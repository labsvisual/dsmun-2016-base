"use strict";angular.module("app",["ui.router","ngCookies","ngLodash"]),angular.module("app"),angular.module("app").config(["$urlRouterProvider","$stateProvider",function(e,t){e.otherwise("/"),t.state("home",{url:"/",templateUrl:"app/templates/homepage.html",controller:"HomePageController"}).state("dashboard",{url:"/dashboard",templateUrl:"app/templates/dashboard.html",controller:"DashboardController"}).state("newConference",{url:"/conferences/new",templateUrl:"app/templates/new-conference.html",controller:"NewConferenceController"}).state("editConference",{url:"/conferences/:guid",templateUrl:"app/templates/edit-conference.html",controller:"EditConferenceController"}).state("registrationForm",{url:"/conferences/:guid/registration",templateUrl:"app/templates/forms/registration.html",controller:"RegistrationFormController"}).state("delegateInformationForm",{url:"/conferences/:guid/delegates",templateUrl:"app/templates/forms/delegate-information.html",controller:"DelegateInformationFormController"}).state("travelArrangementsForm",{url:"/conferences/:guid/travel",templateUrl:"app/templates/forms/travel-arrangements.html",controller:"TravelArrangementsFormController"})}]),angular.module("app").factory("CryptoService",[function(){return{getSha512:function(e){var t=new jsSHA("SHA-512","TEXT");return t.update(e),t.getHash("HEX")}}}]),angular.module("app").factory("RestApiService",["$http","CryptoService","$q",function(e,t,a){var r="http://api.base.dsmun.com:3345";return{Login:function(n){var o={},s=a.defer();return o.username=n.username,o.password=t.getSha512(n.password),e.post(r+"/auth",o).then(function(e){200===e.status&&e.data.data.token?s.resolve({token:e.data.data.token,guid:e.data.data.guid,role:e.data.data.role}):s.reject({message:e.data.message,loggedIn:!1})})["catch"](function(e){s.reject({message:e.data.message,loggedIn:!1})}),s.promise},GetUser:function(t){var n=a.defer();return e.get(r+"/users/"+t.guid+"?token="+t.token).then(function(e){200===e.status&&e.data.data?n.resolve(e.data.data[0]):n.reject({message:e.data.message,error:!0})})["catch"](function(e){n.reject({message:e.data.message,error:!0})}),n.promise},GetAllConferences:function(t){var n=a.defer();return e.get(r+"/conferences?guid="+t.guid+"&token="+t.token).then(function(e){200===e.status&&e.data.data?n.resolve(e.data.data):n.reject({message:e.data.message,error:!0})})["catch"](function(e){n.reject({message:e.data.message,error:!0})}),n.promise},GetConference:function(t){var n=a.defer();return e.get(r+"/conferences/"+t.conferenceGuid+"?token="+t.token+"&guid="+t.guid).then(function(e){200===e.status&&e.data.data?n.resolve(e.data.data[0]):n.reject({message:e.data.message,error:!0})})["catch"](function(e){n.reject({message:e.data.message,error:!0})}),n.promise},Logout:function(t){var n=a.defer();return e.post(r+"/deauth",{guid:t.guid,token:t.token}).then(function(e){200===e.status?n.resolve({statusCode:200}):n.reject({message:e.data.message,error:!0})})["catch"](function(e){n.reject({message:e.data.message,error:!0})}),n.promise},GetStates:function(t){var n=a.defer();return e.get(r+"/metadata/states/"+t).then(function(e){200===e.status&&e.data.data?n.resolve(e.data.data):n.reject({message:e.data.message,error:!0})})["catch"](function(e){n.reject({message:e.data.message,error:!0})}),n.promise},CreateConference:function(t){var n=a.defer(),o={token:t.token,guid:t.guid,data:{registration:t.registration}};return e.post(r+"/conferences",o).then(function(e){200===e.status?n.resolve({data:e.data}):n.reject({message:e.data.message,error:!0})})["catch"](function(e){n.reject({message:e.data.message,error:!0})}),n.promise},UpdateConference:function(t){var n=a.defer(),o={token:t.token,guid:t.guid,data:t.data};return e.put(r+"/conferences/"+t.conferenceGuid,o).then(function(e){200===e.status?n.resolve({data:e.data}):n.reject({message:e.data.message,error:!0})})["catch"](function(e){n.reject({message:e.data.message,error:!0})}),n.promise}}}]),angular.module("app").controller("BasePageController",["$cookies","$state","$window","RestApiService",function(e,t,a,r){var n=this,o=e.get("loginData");this.showLogout=e.get("isLoggedIn")&&o,this.Logout=function(){var t=r.Logout(JSON.parse(o));t.then(function(t){e.remove("isLoggedIn"),e.remove("loginData")})["catch"](function(t){e.remove("isLoggedIn"),e.remove("loginData")}),n.showLogout=!1,a.location="/"}}]),angular.module("app").controller("DashboardController",["RestApiService","$cookies","$state",function(e,t,a){var r=this,n=t.get("isLoggedIn"),o=t.get("loginData");if(!n&&!o)return a.go("home");o=JSON.parse(o);var s=e.GetUser(o);s.then(function(e){r.data=e})["catch"](function(e){console.log("Error Encountered")}),s=e.GetAllConferences(o),s.then(function(e){r.hasConferences=0!==e.length,r.conferences={count:e.length,data:e}})["catch"](function(e){console.log("Error Encountered")})}]),angular.module("app").controller("EditConferenceController",["$stateParams","$cookies","$http","$state","$window","RestApiService",function(e,t,a,r,n,o){var s=this,i=(t.get("isLoggedIn"),t.get("loginData"));i=JSON.parse(i);var c=e.guid;this.guid=c,o.GetConference({conferenceGuid:c,token:i.token,guid:i.guid}).then(function(e){s.conferenceData=e})}]),angular.module("app").controller("HomePageController",["RestApiService","$state","$cookies","$window",function(e,t,a,r){var n=a.get("isLoggedIn"),o=a.get("loginData");n&&o&&t.go("dashboard");var s=this;s.Login=function(){var n=e.Login(s.user);n.then(function(e){a.put("loginData",JSON.stringify(e)),a.put("isLoggedIn",!0),r.location.reload(),t.go("dashboard")})["catch"](function(e){e.loggedIn===!1&&(s.hasMessage=!0,s.messageText=e.message,s.messageClass={red:!0})})}}]),angular.module("app").controller("NewConferenceController",["$cookies","$http","$state","$window","RestApiService",function(e,t,a,r,n){var o=this,s=(e.get("isLoggedIn"),e.get("loginData")),i=this;s=JSON.parse(s),this.countries=[{code:"IN",name:"India"},{code:"US",name:"America"}],this.populateStateList=function(e){n.GetStates(e).then(function(e){o.states=e})},this.cancel=function(){a.go("dashboard")},this.NewConference=function(){o.processing=!0;var e={token:s.token,guid:s.guid,registration:{name:i.conference.registration.facultyAdvisor.firstName+" "+i.conference.registration.facultyAdvisor.lastName,address:{street:i.conference.registration.address.street,city:i.conference.registration.address.city,pin:i.conference.registration.address.pin,state:i.conference.registration.address.state,country:i.conference.registration.address.country},facultyAdvisor:{name:i.conference.registration.facultyAdvisor.firstName+" "+i.conference.registration.facultyAdvisor.lastName,mobileNumber:i.conference.registration.facultyAdvisor.mobile,landlineNumber:i.conference.registration.facultyAdvisor.landline,email:i.conference.registration.facultyAdvisor.email}}};n.CreateConference(e).then(function(e){200===e.data.statusCode?(o.processing=!1,a.go("dashboard")):(o.isError=!0,o.errorMessage=e.data.data.message)})["catch"](function(e){o.isError=!0,o.errorMessage=e.message})}}]),angular.module("app").controller("DelegateInformationFormController",["$cookies","$http","$stateParams","$window","RestApiService",function(e,t,a,r,n){var o=this,s=(e.get("isLoggedIn"),e.get("loginData"));s=JSON.parse(s);var i=a.guid;this.guid=i,n.GetConference({conferenceGuid:i,token:s.token,guid:s.guid}).then(function(e){o.conferenceData=e}),this.AddDelegate=function(){return 17===o.conferenceData.delegateInformation.delegates.length?(o.isMessage=!0,o.messageHeader="Warning!",o.messageText="You can not add any more delegates. The maximum number of delegates per delegation is 17.",o.messageClass={yellow:!0},!1):void o.conferenceData.delegateInformation.delegates.push({name:"Delegate Name"})},this.UpdateForm=function(){o.processing=!0,n.UpdateConference({token:s.token,guid:s.guid,conferenceGuid:o.guid,data:o.conferenceData}).then(function(e){200===e.data.statusCode&&(o.processing=!1,o.isMessage=!0,o.messageHeader="Successful!",o.messageText="All the details were successfully updated!",o.messageClass={blue:!0})})}}]),angular.module("app").controller("MedicalHistoryFormController",["lodash","$cookies","$http","$stateParams","$window","RestApiService",function(e,t,a,r,n,o){var s=this,i=(t.get("isLoggedIn"),t.get("loginData"));i=JSON.parse(i);var c=r.guid;this.guid=c,o.GetConference({conferenceGuid:c,token:i.token,guid:i.guid}).then(function(e){s.conferenceData=e,0===s.conferenceData.medicalHistory.delegates.length}),this.UpdateForm=function(){s.processing=!0,o.UpdateConference({token:i.token,guid:i.guid,conferenceGuid:s.guid,data:s.conferenceData}).then(function(e){200===e.data.statusCode&&(s.processing=!1,s.isMessage=!0,s.messageHeader="Successful!",s.messageText="All the details were successfully updated!",s.messageClass={blue:!0})})}}]),angular.module("app").controller("RegistrationFormController",["$cookies","$http","$stateParams","$window","RestApiService",function(e,t,a,r,n){var o=this,s=a.guid,i=(e.get("isLoggedIn"),e.get("loginData"));this.guid=a.guid,i=JSON.parse(i),n.GetConference({token:i.token,guid:i.guid,conferenceGuid:s}).then(function(e){o.conference=e}),this.UpdateForm=function(){o.processing=!0,n.UpdateConference({token:i.token,guid:i.guid,conferenceGuid:s,data:o.conference}).then(function(e){200===e.data.statusCode&&(o.processing=!1,o.isMessage=!0,o.messageHeader="Successful!",o.messageText="All the details were successfully updated!",o.messageClass={blue:!0})})}}]),angular.module("app").controller("TravelArrangementsFormController",["$cookies","$http","$stateParams","$window","RestApiService",function(e,t,a,r,n){var o=this,s=(e.get("isLoggedIn"),e.get("loginData"));s=JSON.parse(s);var i=a.guid;this.guid=i,n.GetConference({conferenceGuid:i,token:s.token,guid:s.guid}).then(function(e){o.conferenceData=e,o.conferenceData.travelArrangements.onward.arrivalDate&&(o.conferenceData.travelArrangements.onward.arrivalDate=new Date(o.conferenceData.travelArrangements.onward.arrivalDate)),o.conferenceData.travelArrangements.onward.departureDate&&(o.conferenceData.travelArrangements.onward.departureDate=new Date(o.conferenceData.travelArrangements.onward.departureDate)),o.conferenceData.travelArrangements.returnJourney.arrivalDate&&(o.conferenceData.travelArrangements.returnJourney.arrivalDate=new Date(o.conferenceData.travelArrangements.returnJourney.arrivalDate)),o.conferenceData.travelArrangements.returnJourney.departureDate&&(o.conferenceData.travelArrangements.returnJourney.departureDate=new Date(o.conferenceData.travelArrangements.returnJourney.departureDate))}),this.UpdateForm=function(){o.processing=!0,n.UpdateConference({token:s.token,guid:s.guid,conferenceGuid:o.guid,data:o.conferenceData}).then(function(e){200===e.data.statusCode&&(o.processing=!1,o.isMessage=!0,o.messageHeader="Successful!",o.messageText="All the details were successfully updated!",o.messageClass={blue:!0})})}}]);
//# sourceMappingURL=app.min.js.map

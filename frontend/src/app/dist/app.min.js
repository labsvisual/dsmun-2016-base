"use strict";angular.module("app",["ui.router","ngCookies","ngLodash"]),angular.module("app"),angular.module("app").config(["$urlRouterProvider","$stateProvider",function(e,t){e.otherwise("/"),t.state("home",{url:"/",templateUrl:"app/templates/homepage.html"}).state("forgot",{url:"/forgot",templateUrl:"app/templates/forgot-password.html"}).state("dashboard",{url:"/dashboard",templateUrl:"app/templates/dashboard.html"}).state("newConference",{url:"/conferences/new",templateUrl:"app/templates/new-conference.html"}).state("editConference",{url:"/conferences/:guid",templateUrl:"app/templates/edit-conference.html"}).state("registrationForm",{url:"/conferences/:guid/registration",templateUrl:"app/templates/forms/registration.html"}).state("delegateInformationForm",{url:"/conferences/:guid/delegates",templateUrl:"app/templates/forms/delegate-information.html"}).state("travelArrangementsForm",{url:"/conferences/:guid/travel",templateUrl:"app/templates/forms/travel-arrangements.html"}).state("gaCrisisForm",{url:"/conferences/:guid/ga",templateUrl:"app/templates/forms/ga-crisis.html"}).state("dashboardAdmin",{url:"/dashboard/admin",templateUrl:"app/templates/dashboard-admin.html"}).state("editConferenceAdmin",{url:"/dashboard/edit/conferences/:schoolGuid/:guid",templateUrl:"app/templates/edit-conference-admin.html"}).state("addNewUser",{url:"/dashboard/users/new",templateUrl:"app/templates/new-user.html"}).state("userWiseAllocation",{url:"/dashboard/users/allocations",templateUrl:"app/templates/user-wise-allocation.html"})}]),angular.module("app").controller("AdministratorDashboardController",["RestApiService","$cookies","$state","$window","$scope",function(e,t,a,n,r){var s=this,o=t.get("isLoggedIn"),i=t.get("loginData");o&&i&&(i=JSON.parse(i),e.IsValidToken(i.token).then(function(e){e.valid&&(1===i.role?a.go("dashboardAdmin"):a.go("dashboard"))})["catch"](function(e){a.go("home")})),this.sortType="isConfirmed",this.sortReverse=!1,this.ChangeSort=function(e){e===s.sortType?s.sortReverse=!s.sortReverse:s.sortType=e},this.RefreshView=function(){s.isProcessing=!0;var t=!0,a=!0;e.GetAllUsers({token:i.token}).then(function(e){t=!1,s.isProcessing=t||a,s.users=[],e.filter(function(e){1!==e.role&&s.users.push(e)})}),e.GetAllConferencesForAllUsers(i).then(function(e){a=!1,s.isProcessing=t||a,s.allConferences=[],e.map(function(e){e.areFormsFilled=function(){return e.registration&&e.delegateInformation&&e.travelArrangements&&e.gaCrisis&&e.registration.isFormFilled&&e.delegateInformation.isFormFilled&&e.travelArrangements.isFormFilled&&e.gaCrisis.isFormFilled}(),s.allConferences.push(e)})})},this.DeleteConference=function(t){s.isProcessing=!0,e.DeleteConference({guid:i.guid,token:i.token,conferenceGuid:t}).then(function(e){s.isProcessing=!1,s.hasButtonMessage=!0,s.buttonMessage="Conference confirmed!",s.hasMessage=!0,s.messageClass={blue:!0},s.messageText="Conference confirmed!",n.location.reload()})["catch"](function(e){s.isProcessing=!1,s.hasMessage=!0,s.messageClass={red:!0},s.messageText="An error was encountered while executing that operation!"})},this.ConfirmConference=function(t){s.isProcessing=!0,e.ConfirmConference({guid:i.guid,token:i.token,conferenceGuid:t}).then(function(e){s.isProcessing=!1,s.hasButtonMessage=!0,s.buttonMessage="Conference confirmed!",s.hasMessage=!0,s.messageClass={blue:!0},s.messageText="Conference confirmed!",n.location.reload()})["catch"](function(e){s.isProcessing=!1,s.hasMessage=!0,s.messageClass={red:!0},s.messageText="An error was encountered while executing that operation!"})},this.UnconfirmConference=function(t){s.isProcessing=!0,e.UnconfirmConference({guid:i.guid,token:i.token,conferenceGuid:t}).then(function(e){s.isProcessing=!1,s.hasButtonMessage=!0,s.buttonMessage="Conference unconfirmed!",s.hasMessage=!0,s.messageClass={blue:!0},s.messageText="Conference unconfirmed!",n.location.reload()})["catch"](function(e){s.isProcessing=!1,s.hasMessage=!0,s.messageClass={red:!0},s.messageText="An error was encountered while executing that operation!"})},this.RefreshView()}]),angular.module("app").controller("BasePageController",["$cookies","$state","$window","RestApiService",function(e,t,a,n){var r=this,s=e.get("loginData");this.showLogout=e.get("isLoggedIn")&&s,this.Logout=function(){var a=n.Logout(JSON.parse(s));a.then(function(a){e.remove("isLoggedIn"),e.remove("loginData"),r.showLogout=!1,t.go("home")})["catch"](function(a){e.remove("isLoggedIn"),e.remove("loginData"),r.showLogout=!1,t.go("home")})}}]),angular.module("app").controller("DashboardController",["RestApiService","$cookies","$state",function(e,t,a){var n=this,r=t.get("isLoggedIn"),s=t.get("loginData");r&&s&&(s=JSON.parse(s),e.IsValidToken(s.token).then(function(e){e.valid||a.go("home")})["catch"](function(e){a.go("home")})),e.GetUnconfirmedCount(s).then(function(e){n.shouldAddNewButton=0===e.data.count});var o=e.GetUser(s);o.then(function(e){n.data=e})["catch"](function(e){console.error("The application failed to load with the provided parameters; trying to reload internal state.")}),o=e.GetAllConferences(s),o.then(function(e){n.hasConferences=0!==e.length,n.conferences={count:e.length,data:e}})["catch"](function(e){console.error("The application failed to load with the provided parameters; trying to reload internal state."),a.go("home")})}]),angular.module("app").controller("EditConferenceAdminController",["$stateParams","$cookies","$http","$state","$window","RestApiService","lodash",function(e,t,a,n,r,s,o){var i=this,c=t.get("isLoggedIn"),g=t.get("loginData");c&&g&&(g=JSON.parse(g),s.IsValidToken(g.token).then(function(e){e.valid||n.go("home")})["catch"](function(e){n.go("home")}));var d=e.guid;this.guid=d,this.schoolGuid=e.schoolGuid,this.ConfirmConference=function(e){i.isProcessing=!0,s.ConfirmConference({guid:g.guid,token:g.token,conferenceGuid:e}).then(function(e){i.isProcessing=!1,i.hasMessage=!0,i.messageClass={blue:!0},i.messageText="Conference confirmed!"})["catch"](function(e){i.isProcessing=!1,i.hasMessage=!0,i.messageClass={red:!0},i.messageText="An error was encountered while executing that operation!"})},this.GetAllotments=function(e){if(!i.conferenceData.countryAllotment||!i.conferenceData.countryAllotment.allotments)return[];var t=[];return i.conferenceData.countryAllotment.allotments.map(function(a){e===a.name&&t.push(a)}),t},this.AddTeacherEscort=function(){return i.conferenceData.registration&&i.conferenceData.registration.teacherEscorts&&i.conferenceData.registration.teacherEscorts.length>=2?(i.isMessage=!0,i.messageHeader="Warning!",i.messageText="You can not add any more teacher escorts. The maximum number of teacher escorts per delegation is 2.",i.messageClass={yellow:!0},!1):(i.conferenceData.registration.teacherEscorts=i.conferenceData.registration.teacherEscorts||[],i.conferenceData.registration.teacherEscorts.push({name:"Escort Name"}),void i.UpdateView())},this.RemoveEscort=function(e){return i.conferenceData.registration&&i.conferenceData.registration.teacherEscorts&&i.conferenceData.registration.teacherEscorts.length<=0?(i.isMessage=!0,i.messageHeader="Warning!",i.messageText="You can not remove any more delegates.",i.messageClass={yellow:!0},!1):(i.conferenceData.registration.teacherEscorts=i.conferenceData.registration.teacherEscorts||[],i.conferenceData.registration.teacherEscorts.splice(e,1),void i.UpdateView())},this.UpdateView=function(){i.shouldShowNoTeacherEscortMessage=function(){return i.conferenceData.registration&&i.conferenceData.registration.teacherEscorts?0===i.conferenceData.registration.teacherEscorts.length:!1}()},this.AddCountryAllotment=function(){i.conferenceData.countryAllotment=function(){return i.conferenceData.countryAllotment&&i.conferenceData.countryAllotment.allotments?i.conferenceData.countryAllotment:{allotments:[]}}(),i.conferenceData.countryAllotment.allotments.push({name:"",country:""})},this.PostNotification=function(){i.isProcessing=!0,i.notification.guid=e.schoolGuid;var t={guid:g.guid,token:g.token,data:i.notification};s.PostNewNotification(t).then(function(e){i.isProcessing=!1,i.isMessage=!0,i.messageHeader="Success!",i.messageText="A notification was successfully sent to the respective school.",i.messageClass={green:!0},i.notification={}})["catch"](function(e){i.isProcessing=!1,i.isMessage=!0,i.messageHeader="Error!",i.messageText="There was an error in sending the notification.",i.messageClass={red:!0}})},this.AddGADelegate=function(){return i.conferenceData.gaCrisis&&i.conferenceData.gaCrisis.delegates&&i.conferenceData.gaCrisis.delegates.length>=7?(i.isMessage=!0,i.messageHeader="Warning!",i.messageText="You can not add any more delegates. The maximum number of delegates per delegation is 7.",i.messageClass={yellow:!0},!1):(i.conferenceData.gaCrisis=function(){return i.conferenceData.gaCrisis&&i.conferenceData.gaCrisis.delegates?i.conferenceData.gaCrisis:{delegates:[]}}(),i.conferenceData.gaCrisis.delegates.push({name:"Delegate Name"}),void i.UpdateView())},this.RemoveGADelegate=function(e){return i.conferenceData.gaCrisis&&i.conferenceData.gaCrisis.delegates&&i.conferenceData.gaCrisis.delegates.length<=0?(i.isMessage=!0,i.messageHeader="Warning!",i.messageText="You can not remove any more delegates.",i.messageClass={yellow:!0},!1):(i.conferenceData.gaCrisis=function(){return i.conferenceData.gaCrisis&&i.conferenceData.gaCrisis.delegates?i.conferenceData.gaCrisis:{delegates:[]}}(),i.conferenceData.gaCrisis.delegates.splice(e,1),void i.UpdateView())},this.AddDelegate=function(){i.conferenceData.delegateInformation=function(){return i.conferenceData.delegateInformation&&i.conferenceData.delegateInformation.delegates?i.conferenceData.delegateInformation:{delegates:[]}}(),i.conferenceData.delegateInformation.delegates.push({name:"Delegate Name"}),i.UpdateView()},this.RemoveDelegate=function(e){return i.conferenceData.delegateInformation&&i.conferenceData.delegateInformation.delegates&&i.conferenceData.delegateInformation.delegates.length<=0?(i.isMessage=!0,i.messageHeader="Warning!",i.messageText="You can not remove any more delegates.",i.messageClass={yellow:!0},!1):(i.conferenceData.delegateInformation=function(){return i.conferenceData.delegateInformation&&i.conferenceData.delegateInformation.delegates?i.conferenceData.delegateInformation:{delegates:[]}}(),i.conferenceData.delegateInformation.delegates.splice(e,1),void i.UpdateView())},this.UpdateForm=function(){i.processing=!0,s.UpdateConference({token:g.token,guid:g.guid,conferenceGuid:i.guid,data:i.conferenceData}).then(function(e){200===e.data.statusCode&&(i.processing=!1,i.isMessage=!0,i.messageHeader="Successful!",i.messageText="All the details were successfully updated!",i.messageClass={blue:!0})})},this.RefreshView=function(){i.isReloading=!0,s.GetConference({conferenceGuid:d,token:g.token,guid:g.guid}).then(function(e){i.conferenceData=e,i.isReloading=!1,i.fieldClasses={"two fields":i.conferenceData.countryAllotment,field:!i.conferenceData.countryAllotment},i.conferenceData.travelArrangements&&(i.conferenceData.travelArrangements.onward&&(i.conferenceData.travelArrangements.onward.arrivalDate&&(i.conferenceData.travelArrangements.onward.arrivalDate=new Date(i.conferenceData.travelArrangements.onward.arrivalDate)),i.conferenceData.travelArrangements.onward.departureDate&&(i.conferenceData.travelArrangements.onward.departureDate=new Date(i.conferenceData.travelArrangements.onward.departureDate))),i.conferenceData.travelArrangements.returnJourney&&(i.conferenceData.travelArrangements.returnJourney.arrivalDate&&(i.conferenceData.travelArrangements.returnJourney.arrivalDate=new Date(i.conferenceData.travelArrangements.returnJourney.arrivalDate)),i.conferenceData.travelArrangements.returnJourney.departureDate&&(i.conferenceData.travelArrangements.returnJourney.departureDate=new Date(i.conferenceData.travelArrangements.returnJourney.departureDate)))),i.isConferenceConfirmed=i.conferenceData.isConfirmed,i.areFormsFilled=function(){return i.conferenceData.registration&&i.conferenceData.delegateInformation&&i.conferenceData.travelArrangements&&i.conferenceData.gaCrisis&&i.conferenceData.registration.isFormFilled&&i.conferenceData.delegateInformation.isFormFilled&&i.conferenceData.travelArrangements.isFormFilled&&i.conferenceData.gaCrisis.isFormFilled}()})},this.UpdateView=function(){i.shouldShowNoDelegatesMessage=function(){return i.conferenceData.delegateInformation&&i.conferenceData.delegateInformation.delegates?0===i.conferenceData.delegateInformation.delegates.length:!1}()},this.RefreshView()}]),angular.module("app").controller("EditConferenceController",["$stateParams","$cookies","$http","$state","$window","RestApiService",function(e,t,a,n,r,s){var o=this,i=t.get("isLoggedIn"),c=t.get("loginData");i&&c&&(c=JSON.parse(c),s.IsValidToken(c.token).then(function(e){e.valid||n.go("home")})["catch"](function(e){n.go("home")}));var g=e.guid;this.guid=g,s.GetNotifications({guid:c.guid,token:c.token}).then(function(e){o.notifications=e}),s.GetConference({conferenceGuid:g,token:c.token,guid:c.guid}).then(function(e){o.conferenceData=e,o.isAllDone=function(){return o.conferenceData.registration&&o.conferenceData.delegateInformation&&o.conferenceData.travelArrangements&&o.conferenceData.gaCrisis&&o.conferenceData.registration.isFormFilled&&o.conferenceData.delegateInformation.isFormFilled&&o.conferenceData.travelArrangements.isFormFilled&&o.conferenceData.gaCrisis.isFormFilled}()}),this.MarkAsViewed=function(e){s.MarkAsViewed({notificationId:e,guid:c.guid,token:c.token}).then(function(t){var a=angular.element("#"+e).closest(".message");a.addClass("successfully-saved").addClass("hide-opacity")})["catch"](function(e){alert("An error was encountered. Please try again later.")})}}]),angular.module("app").controller("ForgotPasswordController",["RestApiService","$state","$cookies","$window",function(e,t,a,n){var r=this;this.Execute=function(){r.processing=!0;var t=e.ForgotPassword(r.user);t.then(function(e){r.processing=!1,r.hasMessage=!0,r.messageText="An email outling the steps to reset your password has been sent. Check your email!",r.messageClass={blue:!0}})["catch"](function(e){r.processing=!1,e.error&&(r.hasMessage=!0,r.messageText=e.message,r.messageClass={red:!0})})}}]),angular.module("app").controller("HomePageController",["RestApiService","$state","$cookies","$window",function(e,t,a,n){var r=this,s=a.get("isLoggedIn"),o=a.get("loginData");s&&o&&(o=JSON.parse(o),e.IsValidToken(o.token).then(function(e){e.valid||t.go("home")})["catch"](function(e){t.go("home")})),this.Login=function(){r.isProcessing=!0;var n=e.Login(r.user);n.then(function(e){r.hasButtonMessage=!0,r.buttonMessage="Redirecting to dashboard...",a.put("loginData",JSON.stringify(e)),a.put("isLoggedIn",!0),1===e.role?t.go("dashboardAdmin"):t.go("dashboard")})["catch"](function(e){r.isProcessing=!1,e.loggedIn===!1&&(r.hasMessage=!0,r.messageText=e.message,r.messageClass={red:!0})})}}]),angular.module("app").controller("NewConferenceController",["$cookies","$http","$state","$window","RestApiService",function(e,t,a,n,r){var s=this,o=e.get("isLoggedIn"),i=e.get("loginData");o&&i&&(i=JSON.parse(i),r.IsValidToken(i.token).then(function(e){e.valid||a.go("home")})["catch"](function(e){a.go("home")}));var c=this;this.countries=[{code:"IN",name:"India"},{code:"US",name:"America"}],this.populateStateList=function(e){r.GetStates(e).then(function(e){s.states=e})},this.cancel=function(){a.go("dashboard")},this.NewConference=function(){s.processing=!0;var e={token:i.token,guid:i.guid,registration:{name:c.conference.registration.facultyAdvisor.firstName+" "+c.conference.registration.facultyAdvisor.lastName,address:{street:c.conference.registration.address.street,city:c.conference.registration.address.city,pin:c.conference.registration.address.pin,state:c.conference.registration.address.state,country:c.conference.registration.address.country},facultyAdvisor:{name:c.conference.registration.facultyAdvisor.firstName+" "+c.conference.registration.facultyAdvisor.lastName,mobileNumber:c.conference.registration.facultyAdvisor.mobile,landlineNumber:c.conference.registration.facultyAdvisor.landline,email:c.conference.registration.facultyAdvisor.email}}};r.CreateConference(e).then(function(e){200===e.data.statusCode?(s.processing=!1,a.go("dashboard")):(s.isError=!0,s.errorMessage=e.data.data.message)})["catch"](function(e){s.isError=!0,s.errorMessage=e.message})}}]),angular.module("app").controller("NewUserController",["$cookies","$http","$state","$window","RestApiService","CryptoService","lodash",function(e,t,a,n,r,s,o){var i=this,c=e.get("isLoggedIn"),g=e.get("loginData");c&&g&&(g=JSON.parse(g),r.IsValidToken(g.token).then(function(e){e.valid||a.go("home")})["catch"](function(e){a.go("home")}));this.NewUser=function(){i.processing=!0;var e=s.getHmac(i.user.username+i.user.email,g.guid),t={token:g.token,guid:g.guid,hash:e,data:o.assign(i.user,i.metadata)};r.CreateUser(t).then(function(e){200===e.data.statusCode?(i.processing=!1,i.isMessage=!0,i.messageClass={blue:!0},i.messageHeader="User Added",i.messageText="The user "+i.user.username+" was successfully created.",e.data.data&&e.data.data.generatedPassword&&(i.messageText+=" The generated password is "+e.data.data.generatedPassword+".")):(i.processing=!1,i.isMessage=!0,i.messageClass={red:!0},i.messageHeader="An error was encountered",i.messageText=e.message)})["catch"](function(e){i.processing=!1,i.isMessage=!0,i.messageClass={red:!0},i.messageHeader="An error was encountered",i.messageText=e.message})}}]),angular.module("app").controller("ViewUserWiseController",["$cookies","$http","$state","$window","RestApiService","CryptoService","lodash",function(e,t,a,n,r,s,o){var i=e.get("isLoggedIn"),c=e.get("loginData");i&&c&&(c=JSON.parse(c),r.IsValidToken(c.token).then(function(e){e.valid||a.go("home")})["catch"](function(e){a.go("home")}));var g=this;r.GetDelegatesAsCommittees(c).then(function(e){g.committees=e.committees}),g.getDelegates=function(e){return e.delegates}}]),angular.module("app").factory("CryptoService",[function(){return{getSha512:function(e){var t=new jsSHA("SHA-512","TEXT");return t.update(e),t.getHash("HEX")},getHmac:function(e,t){var a=new jsSHA("SHA-512","TEXT");return a.setHMACKey(t,"TEXT"),a.update(e),a.getHMAC("HEX")}}}]),angular.module("app").factory("LoginService",["$cookies","RestApiService","$state","$q",function(e,t,a,n){return{checkLogin:function(){var a=e.get("isLoggedIn"),r=e.get("loginData"),s=n.defer();return a&&r&&(r=JSON.parse(r),t.IsValidToken(r.token).then(function(e){e.valid&&s.resolve({valid:!0,data:r})})["catch"](function(e){s.reject({valid:!0})})),s.promise},getLoginData:function(){var t=JSON.parse(e.get("loginData"));return t}}}]),angular.module("app").factory("RestApiService",["$http","CryptoService","$q",function(e,t,a){var n="http://api.app.dsmun.com";return{IsValidToken:function(t){var r=a.defer();return e.get(n+"/auth/token/valid/"+t).then(function(e){r.resolve(e.data.data)})["catch"](function(e){r.reject({valid:!1})}),r.promise},Login:function(r){var s={},o=a.defer();return s.username=r.username,s.password=t.getSha512(r.password),e.post(n+"/auth",s).then(function(e){200===e.status&&e.data.data.token?o.resolve({token:e.data.data.token,guid:e.data.data.guid,role:e.data.data.role}):o.reject({message:e.data.message,loggedIn:!1})})["catch"](function(e){o.reject({message:e.data.message,loggedIn:!1})}),o.promise},ForgotPassword:function(t){var r={},s=a.defer();return r.username=t.username,e.post(n+"/reset",r).then(function(e){200===e.status?s.resolve():s.reject({message:e.data.message,error:!0})})["catch"](function(e){s.reject({message:e.data.message,error:!0})}),s.promise},PostNewNotification:function(t){var r=a.defer();return e.post(n+"/notifications",{token:t.token,data:t.data,guid:t.guid}).then(function(e){200===e.status||201===e.status?r.resolve():r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},GetUser:function(t){var r=a.defer();return e.get(n+"/users/"+t.guid+"?token="+t.token).then(function(e){200===e.status&&e.data.data?r.resolve(e.data.data[0]):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},GetAllConferences:function(t){var r=a.defer();return e.get(n+"/conferences?guid="+t.guid+"&token="+t.token).then(function(e){200===e.status&&e.data.data?r.resolve(e.data.data):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},GetDelegatesAsCommittees:function(t){var r=a.defer();return e.get(n+"/conferences/as/delegates?guid="+t.guid+"&token="+t.token).then(function(e){200===e.status&&e.data.data?r.resolve(e.data.data):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},GetNotifications:function(t){var r=a.defer();return e.get(n+"/notifications/"+t.guid+"?token="+t.token).then(function(e){200===e.status&&e.data.data?r.resolve(e.data.data):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},MarkAsViewed:function(t){var r=a.defer();return e.get(n+"/notifications/"+t.guid+"/"+t.notificationId+"/viewed?token="+t.token).then(function(e){200===e.status||201===e.status?r.resolve():r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},GetAllUsers:function(t){var r=a.defer();return e.get(n+"/users?token="+t.token).then(function(e){200===e.status&&e.data.data?r.resolve(e.data.data):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},GetAllConferencesForAllUsers:function(t){var r=a.defer();return e.get(n+"/conferences/all?guid="+t.guid+"&token="+t.token).then(function(e){200===e.status&&e.data.data?r.resolve(e.data.data):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},GetUnconfirmedCount:function(t){var r=a.defer();return e.get(n+"/conferences/unconfirmed/count?guid="+t.guid+"&token="+t.token).then(function(e){200===e.status&&e.data.data?r.resolve({data:e.data.data}):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},GetUnconfirmedConferences:function(t){var r=a.defer();return e.get(n+"/conferences/unconfirmed/all?guid="+t.guid+"&token="+t.token).then(function(e){200===e.status&&e.data.data?r.resolve({data:e.data.data}):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},GetConference:function(t){var r=a.defer();return e.get(n+"/conferences/"+t.conferenceGuid+"?token="+t.token+"&guid="+t.guid).then(function(e){200===e.status&&e.data.data?r.resolve(e.data.data[0]):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},Logout:function(t){var r=a.defer();return e.post(n+"/deauth",{guid:t.guid,token:t.token}).then(function(e){200===e.status?r.resolve({statusCode:200}):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},GetStates:function(t){var r=a.defer();return e.get(n+"/metadata/states/"+t).then(function(e){200===e.status&&e.data.data?r.resolve(e.data.data):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},CreateConference:function(t){var r=a.defer(),s={token:t.token,guid:t.guid,data:{registration:t.registration}};return e.post(n+"/conferences",s).then(function(e){200===e.status?r.resolve({data:e.data}):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},DeleteConference:function(t){var r=a.defer();return e["delete"](n+"/conferences/"+t.conferenceGuid+"?token="+t.token+"&guid="+t.guid).then(function(e){200===e.status||201===e.status?r.resolve():r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},CreateUser:function(t){var r=a.defer(),s={token:t.token,data:t.data,hash:t.hash};return e.post(n+"/users",s).then(function(e){200===e.status?r.resolve({data:e.data}):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},UpdateConference:function(t){var r=a.defer(),s={token:t.token,guid:t.guid,data:t.data};return e.put(n+"/conferences/"+t.conferenceGuid,s).then(function(e){200===e.status?r.resolve({data:e.data}):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},ConfirmConference:function(t){var r=a.defer(),s={token:t.token,guid:t.guid};return e.post(n+"/conferences/confirm/"+t.conferenceGuid,s).then(function(e){200===e.status&&e.data.data.confirmationId?r.resolve({data:e.data}):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},UnconfirmConference:function(t){var r=a.defer(),s={token:t.token,guid:t.guid,data:{isConfirmed:!1,confirmationId:""}};return e.put(n+"/conferences/"+t.conferenceGuid,s).then(function(e){200===e.status?r.resolve({data:e.data}):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise}}}]),angular.module("app").filter("reverse",function(){return function(e){return e.slice().reverse()}}),angular.module("app").controller("DelegateInformationFormController",["$cookies","$http","$stateParams","$window","RestApiService",function(e,t,a,n,r){var s=this,o=e.get("isLoggedIn"),i=e.get("loginData"),c=a.guid;o&&i&&(i=JSON.parse(i),r.IsValidToken(i.token).then(function(e){e.valid||$state.go("home")})["catch"](function(e){$state.go("home")})),this.guid=c,r.GetConference({conferenceGuid:c,token:i.token,guid:i.guid}).then(function(e){s.conferenceData=e,s.UpdateView(),s.fieldClasses={"two fields":s.conferenceData.countryAllotment,field:!s.conferenceData.countryAllotment}}),this.GetAllotments=function(e){if(!s.conferenceData.countryAllotment||!s.conferenceData.countryAllotment.allotments)return[];var t=[];return s.conferenceData.countryAllotment.allotments.map(function(a){e===a.name&&t.push(a)}),t},this.AddDelegate=function(){return s.conferenceData.delegateInformation&&s.conferenceData.delegateInformation.delegates&&s.conferenceData.delegateInformation.delegates.length>=17?(s.isMessage=!0,s.messageHeader="Warning!",s.messageText="You can not add any more delegates. The maximum number of delegates per delegation is 17.",s.messageClass={yellow:!0},!1):(s.conferenceData.delegateInformation=function(){return s.conferenceData.delegateInformation&&s.conferenceData.delegateInformation.delegates?s.conferenceData.delegateInformation:{delegates:[]}}(),s.conferenceData.delegateInformation.delegates.push({name:"Delegate Name"}),void s.UpdateView())},this.RemoveDelegate=function(e){return s.conferenceData.delegateInformation&&s.conferenceData.delegateInformation.delegates&&s.conferenceData.delegateInformation.delegates.length<=0?(s.isMessage=!0,s.messageHeader="Warning!",s.messageText="You can not remove any more delegates.",s.messageClass={yellow:!0},!1):(s.conferenceData.delegateInformation=function(){return s.conferenceData.delegateInformation&&s.conferenceData.delegateInformation.delegates?s.conferenceData.delegateInformation:{delegates:[]}}(),s.conferenceData.delegateInformation.delegates.splice(e,1),void s.UpdateView())},this.UpdateView=function(){s.shouldShowNoDelegatesMessage=function(){return s.conferenceData.delegateInformation&&s.conferenceData.delegateInformation.delegates?0===s.conferenceData.delegateInformation.delegates.length:!1}()},this.UpdateForm=function(){s.processing=!0,r.UpdateConference({token:i.token,guid:i.guid,conferenceGuid:s.guid,data:s.conferenceData}).then(function(e){200===e.data.statusCode&&(s.processing=!1,s.isMessage=!0,s.messageHeader="Successful!",s.messageText="All the details were successfully updated!",s.messageClass={blue:!0})})}}]),angular.module("app").controller("GaCrisisFormController",["lodash","$cookies","$http","$stateParams","$window","RestApiService",function(e,t,a,n,r,s){var o=this,i=t.get("isLoggedIn"),c=t.get("loginData");i&&c&&(c=JSON.parse(c),s.IsValidToken(c.token).then(function(e){e.valid||$state.go("home")})["catch"](function(e){$state.go("home")}));var g=n.guid;this.guid=g,s.GetConference({conferenceGuid:g,token:c.token,guid:c.guid}).then(function(e){o.conferenceData=e,o.UpdateView()}),this.RemoveDelegate=function(e){return o.conferenceData.gaCrisis&&o.conferenceData.gaCrisis.delegates&&o.conferenceData.gaCrisis.delegates.length<=0?(o.isMessage=!0,o.messageHeader="Warning!",o.messageText="You can not remove any more delegates.",o.messageClass={yellow:!0},!1):(o.conferenceData.gaCrisis=function(){return o.conferenceData.gaCrisis&&o.conferenceData.gaCrisis.delegates?o.conferenceData.gaCrisis:{delegates:[]}}(),o.conferenceData.gaCrisis.delegates.splice(e,1),void o.UpdateView())},this.UpdateView=function(){o.shouldShowNoDelegatesMessage=function(){return o.conferenceData.gaCrisis&&o.conferenceData.gaCrisis.delegates?0===o.conferenceData.gaCrisis.delegates.length:!1}()},this.AddDelegate=function(){return o.conferenceData.gaCrisis&&o.conferenceData.gaCrisis.delegates&&o.conferenceData.gaCrisis.delegates.length>=7?(o.isMessage=!0,o.messageHeader="Warning!",o.messageText="You can not add any more delegates. The maximum number of delegates per delegation is 7.",o.messageClass={yellow:!0},!1):(o.conferenceData.gaCrisis=function(){return o.conferenceData.gaCrisis&&o.conferenceData.gaCrisis.delegates?o.conferenceData.gaCrisis:{delegates:[]}}(),o.conferenceData.gaCrisis.delegates.push({name:"Delegate Name"}),void o.UpdateView())},this.UpdateForm=function(){o.processing=!0,s.UpdateConference({token:c.token,guid:c.guid,conferenceGuid:o.guid,data:o.conferenceData}).then(function(e){200===e.data.statusCode&&(o.processing=!1,o.isMessage=!0,o.messageHeader="Successful!",o.messageText="All the details were successfully updated!",o.messageClass={blue:!0})})}}]),angular.module("app").controller("MedicalHistoryFormController",["lodash","$cookies","$http","$stateParams","$window","RestApiService",function(e,t,a,n,r,s){var o=this,i=t.get("isLoggedIn"),c=t.get("loginData");i&&c&&(c=JSON.parse(c),s.IsValidToken(c.token).then(function(e){e.valid||$state.go("home")})["catch"](function(e){$state.go("home")}));var g=n.guid;this.guid=g,s.GetConference({conferenceGuid:g,token:c.token,guid:c.guid}).then(function(e){o.conferenceData=e}),this.UpdateForm=function(){o.processing=!0,s.UpdateConference({token:c.token,guid:c.guid,conferenceGuid:o.guid,data:o.conferenceData}).then(function(e){200===e.data.statusCode&&(o.processing=!1,o.isMessage=!0,o.messageHeader="Successful!",o.messageText="All the details were successfully updated!",o.messageClass={blue:!0})})}}]),angular.module("app").controller("RegistrationFormController",["$cookies","$http","$stateParams","$window","RestApiService",function(e,t,a,n,r){var s=this,o=a.guid,i=e.get("isLoggedIn"),c=e.get("loginData");i&&c&&(c=JSON.parse(c),r.IsValidToken(c.token).then(function(e){e.valid||$state.go("home")})["catch"](function(e){$state.go("home")})),this.guid=a.guid,r.GetConference({token:c.token,guid:c.guid,conferenceGuid:o}).then(function(e){s.conferenceData=e,s.UpdateView()}),this.AddTeacherEscort=function(){return s.conferenceData.registration&&s.conferenceData.registration.teacherEscorts&&s.conferenceData.registration.teacherEscorts.length>=2?(s.isMessage=!0,s.messageHeader="Warning!",s.messageText="You can not add any more teacher escorts. The maximum number of teacher escorts per delegation is 2.",s.messageClass={yellow:!0},!1):(s.conferenceData.registration.teacherEscorts=s.conferenceData.registration.teacherEscorts||[],
s.conferenceData.registration.teacherEscorts.push({name:"Escort Name"}),void s.UpdateView())},this.RemoveEscort=function(e){return s.conferenceData.registration&&s.conferenceData.registration.teacherEscorts&&s.conferenceData.registration.teacherEscorts.length<=0?(s.isMessage=!0,s.messageHeader="Warning!",s.messageText="You can not remove any more delegates.",s.messageClass={yellow:!0},!1):(s.conferenceData.registration.teacherEscorts=s.conferenceData.registration.teacherEscorts||[],s.conferenceData.registration.teacherEscorts.splice(e,1),void s.UpdateView())},this.UpdateView=function(){s.shouldShowNoTeacherEscortMessage=function(){return s.conferenceData.registration&&s.conferenceData.registration.teacherEscorts?0===s.conferenceData.registration.teacherEscorts.length:!1}()},this.UpdateForm=function(){s.processing=!0,r.UpdateConference({token:c.token,guid:c.guid,conferenceGuid:o,data:s.conferenceData}).then(function(e){200===e.data.statusCode&&(s.processing=!1,s.isMessage=!0,s.messageHeader="Successful!",s.messageText="All the details were successfully updated!",s.messageClass={blue:!0})})}}]),angular.module("app").controller("TravelArrangementsFormController",["$cookies","$http","$stateParams","$window","RestApiService",function(e,t,a,n,r){var s=this,o=e.get("isLoggedIn"),i=e.get("loginData");o&&i&&(i=JSON.parse(i),r.IsValidToken(i.token).then(function(e){e.valid||$state.go("home")})["catch"](function(e){$state.go("home")}));var c=a.guid;this.guid=c,r.GetConference({conferenceGuid:c,token:i.token,guid:i.guid}).then(function(e){s.conferenceData=e,s.conferenceData.travelArrangements&&(s.conferenceData.travelArrangements.onward&&(s.conferenceData.travelArrangements.onward.arrivalDate&&(s.conferenceData.travelArrangements.onward.arrivalDate=new Date(s.conferenceData.travelArrangements.onward.arrivalDate)),s.conferenceData.travelArrangements.onward.departureDate&&(s.conferenceData.travelArrangements.onward.departureDate=new Date(s.conferenceData.travelArrangements.onward.departureDate))),s.conferenceData.travelArrangements.returnJourney&&(s.conferenceData.travelArrangements.returnJourney.arrivalDate&&(s.conferenceData.travelArrangements.returnJourney.arrivalDate=new Date(s.conferenceData.travelArrangements.returnJourney.arrivalDate)),s.conferenceData.travelArrangements.returnJourney.departureDate&&(s.conferenceData.travelArrangements.returnJourney.departureDate=new Date(s.conferenceData.travelArrangements.returnJourney.departureDate))))}),this.UpdateForm=function(){s.processing=!0,r.UpdateConference({token:i.token,guid:i.guid,conferenceGuid:s.guid,data:s.conferenceData}).then(function(e){200===e.data.statusCode&&(s.processing=!1,s.isMessage=!0,s.messageHeader="Successful!",s.messageText="All the details were successfully updated!",s.messageClass={blue:!0})})}}]);
//# sourceMappingURL=app.min.js.map

"use strict";angular.module("app",["ui.router","ngCookies","ngLodash"]),angular.module("app"),angular.module("app").config(["$urlRouterProvider","$stateProvider",function(e,a){e.otherwise("/"),a.state("home",{url:"/",templateUrl:"app/templates/homepage.html"}).state("forgot",{url:"/forgot",templateUrl:"app/templates/forgot-password.html"}).state("dashboard",{url:"/dashboard",templateUrl:"app/templates/dashboard.html"}).state("newConference",{url:"/conferences/new",templateUrl:"app/templates/new-conference.html"}).state("editConference",{url:"/conferences/:guid",templateUrl:"app/templates/edit-conference.html"}).state("registrationForm",{url:"/conferences/:guid/registration",templateUrl:"app/templates/forms/registration.html"}).state("delegateInformationForm",{url:"/conferences/:guid/delegates",templateUrl:"app/templates/forms/delegate-information.html"}).state("travelArrangementsForm",{url:"/conferences/:guid/travel",templateUrl:"app/templates/forms/travel-arrangements.html"}).state("gaCrisisForm",{url:"/conferences/:guid/ga",templateUrl:"app/templates/forms/ga-crisis.html"}).state("dashboardAdmin",{url:"/dashboard/admin",templateUrl:"app/templates/dashboard-admin.html"}).state("editConferenceAdmin",{url:"/dashboard/edit/conferences/:guid",templateUrl:"app/templates/edit-conference-admin.html"}).state("addNewUser",{url:"/dashboard/users/new",templateUrl:"app/templates/new-user.html"})}]),angular.module("app").controller("AdministratorDashboardController",["RestApiService","$cookies","$state","$window",function(e,a,t,n){var r=this,s=a.get("isLoggedIn"),o=a.get("loginData");return s||o?(o=JSON.parse(o),e.GetUser(o).then(function(e){var a=e.school_name,t=e.teacher_escort,n=e.username;r.data={school_name:a,teacher_escort:t,username:n}}),e.GetAllConferencesForAllUsers(o).then(function(e){r.allConferences=[],e.map(function(e){e.areFormsFilled=function(){return e.registration&&e.delegateInformation&&e.travelArrangements&&e.gaCrisis&&e.registration.isFormFilled&&e.delegateInformation.isFormFilled&&e.travelArrangements.isFormFilled&&e.gaCrisis.isFormFilled}(),r.allConferences.push(e)})}),this.sortType="isConfirmed",this.sortReverse=!1,this.ChangeSort=function(e){e===r.sortType?r.sortReverse=!r.sortReverse:r.sortType=e},this.ConfirmConference=function(a){r.isProcessing=!0,e.ConfirmConference({guid:o.guid,token:o.token,conferenceGuid:a}).then(function(e){r.isProcessing=!1,r.hasButtonMessage=!0,r.buttonMessage="Conference confirmed!",r.hasMessage=!0,r.messageClass={blue:!0},r.messageText="Conference confirmed!",n.location.reload()})["catch"](function(e){r.isProcessing=!1,r.hasMessage=!0,r.messageClass={red:!0},r.messageText="An error was encountered while executing that operation!"})},void(this.UnconfirmConference=function(a){r.isProcessing=!0,e.UnconfirmConference({guid:o.guid,token:o.token,conferenceGuid:a}).then(function(e){r.isProcessing=!1,r.hasButtonMessage=!0,r.buttonMessage="Conference unconfirmed!",r.hasMessage=!0,r.messageClass={blue:!0},r.messageText="Conference unconfirmed!",n.location.reload()})["catch"](function(e){r.isProcessing=!1,r.hasMessage=!0,r.messageClass={red:!0},r.messageText="An error was encountered while executing that operation!"})})):t.go("home")}]),angular.module("app").controller("BasePageController",["$cookies","$state","$window","RestApiService",function(e,a,t,n){var r=this,s=e.get("loginData");this.showLogout=e.get("isLoggedIn")&&s,this.Logout=function(){var a=n.Logout(JSON.parse(s));a.then(function(a){e.remove("isLoggedIn"),e.remove("loginData")})["catch"](function(a){e.remove("isLoggedIn"),e.remove("loginData")}),r.showLogout=!1,t.location="/"}}]),angular.module("app").controller("DashboardController",["RestApiService","$cookies","$state",function(e,a,t){var n=this,r=a.get("isLoggedIn"),s=a.get("loginData");if(!r&&!s)return t.go("home");s=JSON.parse(s),e.GetUnconfirmedCount(s).then(function(e){n.shouldAddNewButton=0===e.data.count});var o=e.GetUser(s);o.then(function(e){n.data=e})["catch"](function(e){console.log("Error Encountered")}),o=e.GetAllConferences(s),o.then(function(e){n.hasConferences=0!==e.length,n.conferences={count:e.length,data:e}})["catch"](function(e){console.log("Error Encountered")})}]),angular.module("app").controller("EditConferenceAdminController",["$stateParams","$cookies","$http","$state","$window","RestApiService",function(e,a,t,n,r,s){var o=this,i=(a.get("isLoggedIn"),a.get("loginData"));i=JSON.parse(i);var c=e.guid;this.guid=c,this.ConfirmConference=function(e){o.isProcessing=!0,s.ConfirmConference({guid:i.guid,token:i.token,conferenceGuid:e}).then(function(e){o.isProcessing=!1,o.hasMessage=!0,o.messageClass={blue:!0},o.messageText="Conference confirmed!"})["catch"](function(e){o.isProcessing=!1,o.hasMessage=!0,o.messageClass={red:!0},o.messageText="An error was encountered while executing that operation!"})},this.AddDelegate=function(){return o.conferenceData.delegateInformation&&o.conferenceData.delegateInformation.delegates&&17===o.conferenceData.delegateInformation.delegates.length?(o.isMessage=!0,o.messageHeader="Warning!",o.messageText="You can not add any more delegates. The maximum number of delegates per delegation is 17.",o.messageClass={yellow:!0},!1):void(o.conferenceData.delegateInformation?(o.conferenceData.delegateInformation.delegates=o.conferenceData.delegateInformation.delegates||[],o.conferenceData.delegateInformation.delegates.push({name:"Delegate Name"})):(o.conferenceData.delegateInformation={},o.conferenceData.delegateInformation={delegates:[]},o.conferenceData.delegateInformation.delegates.push({name:"Delegate Name"})))},this.UpdateForm=function(){o.processing=!0,s.UpdateConference({token:i.token,guid:i.guid,conferenceGuid:o.guid,data:o.conferenceData}).then(function(e){200===e.data.statusCode&&(o.processing=!1,o.isMessage=!0,o.messageHeader="Successful!",o.messageText="All the details were successfully updated!",o.messageClass={blue:!0})})},this.AddGADelegate=function(){return o.conferenceData.gaCrisis.delegates&&5===o.conferenceData.gaCrisis.delegates.length?(o.isMessage=!0,o.messageHeader="Warning!",o.messageText="You can not add any more delegates. The maximum number of delegates per delegation is 5.",o.messageClass={yellow:!0},!1):void(o.conferenceData.gaCrisis&&o.conferenceData.gaCrisis.delegates?o.conferenceData.gaCrisis.delegates.push({name:"Delegate Name"}):(o.conferenceData.gaCrisis={delegates:[]},o.conferenceData.gaCrisis.delegates.push({name:"Delegate Name"})))},s.GetConference({conferenceGuid:c,token:i.token,guid:i.guid}).then(function(e){o.conferenceData=e,o.isConferenceConfirmed=o.conferenceData.isConfirmed,o.areFormsFilled=function(){return o.conferenceData.registration&&o.conferenceData.delegateInformation&&o.conferenceData.travelArrangements&&o.conferenceData.gaCrisis&&o.conferenceData.registration.isFormFilled&&o.conferenceData.delegateInformation.isFormFilled&&o.conferenceData.travelArrangements.isFormFilled&&o.conferenceData.gaCrisis.isFormFilled}()})}]),angular.module("app").controller("EditConferenceController",["$stateParams","$cookies","$http","$state","$window","RestApiService",function(e,a,t,n,r,s){var o=this,i=(a.get("isLoggedIn"),a.get("loginData"));i=JSON.parse(i);var c=e.guid;this.guid=c,s.GetConference({conferenceGuid:c,token:i.token,guid:i.guid}).then(function(e){o.conferenceData=e,o.isAllDone=function(){return o.conferenceData.registration&&o.conferenceData.delegateInformation&&o.conferenceData.travelArrangements&&o.conferenceData.gaCrisis&&o.conferenceData.registration.isFormFilled&&o.conferenceData.delegateInformation.isFormFilled&&o.conferenceData.travelArrangements.isFormFilled&&o.conferenceData.gaCrisis.isFormFilled}()})}]),angular.module("app").controller("ForgotPasswordController",["RestApiService","$state","$cookies","$window",function(e,a,t,n){var r=this,s=this;s.Execute=function(){r.processing=!0;var a=e.ForgotPassword(s.user);a.then(function(e){r.processing=!1,s.hasMessage=!0,s.messageText="An email outling the steps to reset your password has been sent. Check your email!",s.messageClass={blue:!0}})["catch"](function(e){r.processing=!1,e.error&&(s.hasMessage=!0,s.messageText=e.message,s.messageClass={red:!0})})}}]),angular.module("app").controller("HomePageController",["RestApiService","$state","$cookies","$window",function(e,a,t,n){var r=t.get("isLoggedIn"),s=t.get("loginData");r&&s&&a.go("dashboard");var o=this;o.Login=function(){o.isProcessing=!0;var n=e.Login(o.user);n.then(function(e){o.isProcessing=!1,o.hasButtonMessage=!0,o.buttonMessage="Redirecting to dashboard...",t.put("loginData",JSON.stringify(e)),t.put("isLoggedIn",!0),1===e.role?a.go("dashboardAdmin"):a.go("dashboard")})["catch"](function(e){o.isProcessing=!1,e.loggedIn===!1&&(o.hasMessage=!0,o.messageText=e.message,o.messageClass={red:!0})})}}]),angular.module("app").controller("NewConferenceController",["$cookies","$http","$state","$window","RestApiService",function(e,a,t,n,r){var s=this,o=(e.get("isLoggedIn"),e.get("loginData")),i=this;o=JSON.parse(o),this.countries=[{code:"IN",name:"India"},{code:"US",name:"America"}],this.populateStateList=function(e){r.GetStates(e).then(function(e){s.states=e})},this.cancel=function(){t.go("dashboard")},this.NewConference=function(){s.processing=!0;var e={token:o.token,guid:o.guid,registration:{name:i.conference.registration.facultyAdvisor.firstName+" "+i.conference.registration.facultyAdvisor.lastName,address:{street:i.conference.registration.address.street,city:i.conference.registration.address.city,pin:i.conference.registration.address.pin,state:i.conference.registration.address.state,country:i.conference.registration.address.country},facultyAdvisor:{name:i.conference.registration.facultyAdvisor.firstName+" "+i.conference.registration.facultyAdvisor.lastName,mobileNumber:i.conference.registration.facultyAdvisor.mobile,landlineNumber:i.conference.registration.facultyAdvisor.landline,email:i.conference.registration.facultyAdvisor.email}}};r.CreateConference(e).then(function(e){200===e.data.statusCode?(s.processing=!1,t.go("dashboard")):(s.isError=!0,s.errorMessage=e.data.data.message)})["catch"](function(e){s.isError=!0,s.errorMessage=e.message})}}]),angular.module("app").controller("NewUserController",["$cookies","$http","$state","$window","RestApiService","CryptoService",function(e,a,t,n,r,s){var o=this,i=(e.get("isLoggedIn"),e.get("loginData"));i=JSON.parse(i),this.NewUser=function(){o.processing=!0;var e=s.getHmac(o.user.username+o.user.email,i.guid),a={token:i.token,guid:i.guid,hash:e,data:o.user};r.CreateUser(a).then(function(e){200===e.data.statusCode?(o.processing=!1,o.isMessage=!0,o.messageClass={blue:!0},o.messageHeader="User Added",o.messageText="The user "+o.user.username+" was successfully created."):(o.processing=!1,o.isMessage=!0,o.messageClass={red:!0},o.messageHeader="An error was encountered",o.messageText=e.message)})["catch"](function(e){o.processing=!1,o.isMessage=!0,o.messageClass={red:!0},o.messageHeader="An error was encountered",console.log(e),o.messageText=e.message})}}]),angular.module("app").factory("CryptoService",[function(){return{getSha512:function(e){var a=new jsSHA("SHA-512","TEXT");return a.update(e),a.getHash("HEX")},getHmac:function(e,a){var t=new jsSHA("SHA-512","TEXT");return t.setHMACKey(a,"TEXT"),t.update(e),t.getHMAC("HEX")}}}]),angular.module("app").factory("RestApiService",["$http","CryptoService","$q",function(e,a,t){var n="http://api.app.beta.dsmun.com";return{Login:function(r){var s={},o=t.defer();return s.username=r.username,s.password=a.getSha512(r.password),e.post(n+"/auth",s).then(function(e){200===e.status&&e.data.data.token?o.resolve({token:e.data.data.token,guid:e.data.data.guid,role:e.data.data.role}):o.reject({message:e.data.message,loggedIn:!1})})["catch"](function(e){o.reject({message:e.data.message,loggedIn:!1})}),o.promise},ForgotPassword:function(a){var r={},s=t.defer();return r.username=a.username,e.post(n+"/forgot",r).then(function(e){200===e.status?s.resolve():s.reject({message:e.data.message,error:!0})})["catch"](function(e){s.reject({message:e.data.message,error:!0})}),s.promise},GetUser:function(a){var r=t.defer();return e.get(n+"/users/"+a.guid+"?token="+a.token).then(function(e){200===e.status&&e.data.data?r.resolve(e.data.data[0]):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},GetAllConferences:function(a){var r=t.defer();return e.get(n+"/conferences?guid="+a.guid+"&token="+a.token).then(function(e){200===e.status&&e.data.data?r.resolve(e.data.data):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},GetAllConferencesForAllUsers:function(a){var r=t.defer();return e.get(n+"/conferences/all?guid="+a.guid+"&token="+a.token).then(function(e){200===e.status&&e.data.data?r.resolve(e.data.data):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},GetUnconfirmedCount:function(a){var r=t.defer();return e.get(n+"/conferences/unconfirmed/count?guid="+a.guid+"&token="+a.token).then(function(e){200===e.status&&e.data.data?r.resolve({data:e.data.data}):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},GetUnconfirmedConferences:function(a){var r=t.defer();return e.get(n+"/conferences/unconfirmed/all?guid="+a.guid+"&token="+a.token).then(function(e){200===e.status&&e.data.data?r.resolve({data:e.data.data}):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},GetConference:function(a){var r=t.defer();return e.get(n+"/conferences/"+a.conferenceGuid+"?token="+a.token+"&guid="+a.guid).then(function(e){200===e.status&&e.data.data?r.resolve(e.data.data[0]):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},Logout:function(a){var r=t.defer();return e.post(n+"/deauth",{guid:a.guid,token:a.token}).then(function(e){200===e.status?r.resolve({statusCode:200}):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},GetStates:function(a){var r=t.defer();return e.get(n+"/metadata/states/"+a).then(function(e){200===e.status&&e.data.data?r.resolve(e.data.data):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},CreateConference:function(a){var r=t.defer(),s={token:a.token,guid:a.guid,data:{registration:a.registration}};return e.post(n+"/conferences",s).then(function(e){200===e.status?r.resolve({data:e.data}):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},CreateUser:function(a){var r=t.defer(),s={token:a.token,data:a.data,hash:a.hash};return e.post(n+"/users",s).then(function(e){200===e.status?r.resolve({data:e.data}):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},UpdateConference:function(a){var r=t.defer(),s={token:a.token,guid:a.guid,data:a.data};return e.put(n+"/conferences/"+a.conferenceGuid,s).then(function(e){200===e.status?r.resolve({data:e.data}):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},ConfirmConference:function(a){var r=t.defer(),s={token:a.token,guid:a.guid,data:{isConfirmed:!0}};return e.put(n+"/conferences/"+a.conferenceGuid,s).then(function(e){200===e.status?r.resolve({data:e.data}):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise},UnconfirmConference:function(a){var r=t.defer(),s={token:a.token,guid:a.guid,data:{isConfirmed:!1}};return e.put(n+"/conferences/"+a.conferenceGuid,s).then(function(e){200===e.status?r.resolve({data:e.data}):r.reject({message:e.data.message,error:!0})})["catch"](function(e){r.reject({message:e.data.message,error:!0})}),r.promise}}}]),angular.module("app").controller("DelegateInformationFormController",["$cookies","$http","$stateParams","$window","RestApiService",function(e,a,t,n,r){var s=this,o=(e.get("isLoggedIn"),e.get("loginData"));o=JSON.parse(o);var i=t.guid;this.guid=i,r.GetConference({conferenceGuid:i,token:o.token,guid:o.guid}).then(function(e){s.conferenceData=e}),this.AddDelegate=function(){return s.conferenceData.delegateInformation&&17===s.conferenceData.delegateInformation.delegates.length?(s.isMessage=!0,s.messageHeader="Warning!",s.messageText="You can not add any more delegates. The maximum number of delegates per delegation is 17.",s.messageClass={yellow:!0},!1):void(s.conferenceData.delegateInformation?s.conferenceData.delegateInformation.delegates.push({name:"Delegate Name"}):(s.conferenceData.delegateInformation={},s.conferenceData.delegateInformation={delegates:[]},s.conferenceData.delegateInformation.delegates.push({name:"Delegate Name"})))},this.UpdateForm=function(){s.processing=!0,r.UpdateConference({token:o.token,guid:o.guid,conferenceGuid:s.guid,data:s.conferenceData}).then(function(e){200===e.data.statusCode&&(s.processing=!1,s.isMessage=!0,s.messageHeader="Successful!",s.messageText="All the details were successfully updated!",s.messageClass={blue:!0})})}}]),angular.module("app").controller("GaCrisisFormController",["lodash","$cookies","$http","$stateParams","$window","RestApiService",function(e,a,t,n,r,s){var o=this,i=(a.get("isLoggedIn"),a.get("loginData"));i=JSON.parse(i);var c=n.guid;this.guid=c,s.GetConference({conferenceGuid:c,token:i.token,guid:i.guid}).then(function(e){o.conferenceData=e}),this.AddDelegate=function(){return o.conferenceData.gaCrisis.delegates&&5===o.conferenceData.gaCrisis.delegates.length?(o.isMessage=!0,o.messageHeader="Warning!",o.messageText="You can not add any more delegates. The maximum number of delegates per delegation is 5.",o.messageClass={yellow:!0},!1):void(o.conferenceData.gaCrisis&&o.conferenceData.gaCrisis.delegates?o.conferenceData.gaCrisis.delegates.push({name:"Delegate Name"}):(o.conferenceData.gaCrisis={delegates:[]},o.conferenceData.gaCrisis.delegates.push({name:"Delegate Name"})))},this.UpdateForm=function(){o.processing=!0,s.UpdateConference({token:i.token,guid:i.guid,conferenceGuid:o.guid,data:o.conferenceData}).then(function(e){200===e.data.statusCode&&(o.processing=!1,o.isMessage=!0,o.messageHeader="Successful!",o.messageText="All the details were successfully updated!",o.messageClass={blue:!0})})}}]),angular.module("app").controller("MedicalHistoryFormController",["lodash","$cookies","$http","$stateParams","$window","RestApiService",function(e,a,t,n,r,s){var o=this,i=(a.get("isLoggedIn"),a.get("loginData"));i=JSON.parse(i);var c=n.guid;this.guid=c,s.GetConference({conferenceGuid:c,token:i.token,guid:i.guid}).then(function(e){o.conferenceData=e,0===o.conferenceData.medicalHistory.delegates.length}),this.UpdateForm=function(){o.processing=!0,s.UpdateConference({token:i.token,guid:i.guid,conferenceGuid:o.guid,data:o.conferenceData}).then(function(e){200===e.data.statusCode&&(o.processing=!1,o.isMessage=!0,o.messageHeader="Successful!",o.messageText="All the details were successfully updated!",o.messageClass={blue:!0})})}}]),angular.module("app").controller("RegistrationFormController",["$cookies","$http","$stateParams","$window","RestApiService",function(e,a,t,n,r){var s=this,o=t.guid,i=(e.get("isLoggedIn"),e.get("loginData"));this.guid=t.guid,i=JSON.parse(i),r.GetConference({token:i.token,guid:i.guid,conferenceGuid:o}).then(function(e){s.conference=e}),this.UpdateForm=function(){s.processing=!0,r.UpdateConference({token:i.token,guid:i.guid,conferenceGuid:o,data:s.conference}).then(function(e){200===e.data.statusCode&&(s.processing=!1,s.isMessage=!0,s.messageHeader="Successful!",s.messageText="All the details were successfully updated!",s.messageClass={blue:!0})})}}]),angular.module("app").controller("TravelArrangementsFormController",["$cookies","$http","$stateParams","$window","RestApiService",function(e,a,t,n,r){var s=this,o=(e.get("isLoggedIn"),e.get("loginData"));o=JSON.parse(o);var i=t.guid;this.guid=i,r.GetConference({conferenceGuid:i,token:o.token,guid:o.guid}).then(function(e){s.conferenceData=e,s.conferenceData.travelArrangements.onward.arrivalDate&&(s.conferenceData.travelArrangements.onward.arrivalDate=new Date(s.conferenceData.travelArrangements.onward.arrivalDate)),s.conferenceData.travelArrangements.onward.departureDate&&(s.conferenceData.travelArrangements.onward.departureDate=new Date(s.conferenceData.travelArrangements.onward.departureDate)),s.conferenceData.travelArrangements.returnJourney.arrivalDate&&(s.conferenceData.travelArrangements.returnJourney.arrivalDate=new Date(s.conferenceData.travelArrangements.returnJourney.arrivalDate)),s.conferenceData.travelArrangements.returnJourney.departureDate&&(s.conferenceData.travelArrangements.returnJourney.departureDate=new Date(s.conferenceData.travelArrangements.returnJourney.departureDate))}),this.UpdateForm=function(){s.processing=!0,r.UpdateConference({token:o.token,guid:o.guid,conferenceGuid:s.guid,data:s.conferenceData}).then(function(e){200===e.data.statusCode&&(s.processing=!1,s.isMessage=!0,s.messageHeader="Successful!",s.messageText="All the details were successfully updated!",s.messageClass={blue:!0})})}}]);
//# sourceMappingURL=app.min.js.map

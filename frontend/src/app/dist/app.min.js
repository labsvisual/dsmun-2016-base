'use strict';

angular.module('app', ['ui.router', 'ngCookies', 'ngLodash']);

angular.module('app');
'use strict';

angular.module('app').config(['$urlRouterProvider', '$stateProvider', function ($urlRouterProvider, $stateProvider) {

    $urlRouterProvider.otherwise('/');

    $stateProvider.state('home', {

        url: '/',
        templateUrl: 'app/templates/homepage.html'

    }).state('forgot', {

        url: '/forgot',
        templateUrl: 'app/templates/forgot-password.html'

    }).state('dashboard', {

        url: '/dashboard',
        templateUrl: 'app/templates/dashboard.html'

    }).state('newConference', {

        url: '/conferences/new',
        templateUrl: 'app/templates/new-conference.html'

    }).state('editConference', {

        url: '/conferences/:guid',
        templateUrl: 'app/templates/edit-conference.html'

    }).state('registrationForm', {

        url: '/conferences/:guid/registration',
        templateUrl: 'app/templates/forms/registration.html'

    }).state('delegateInformationForm', {

        url: '/conferences/:guid/delegates',
        templateUrl: 'app/templates/forms/delegate-information.html'

    }).state('travelArrangementsForm', {

        url: '/conferences/:guid/travel',
        templateUrl: 'app/templates/forms/travel-arrangements.html'

    }).state('gaCrisisForm', {

        url: '/conferences/:guid/ga',
        templateUrl: 'app/templates/forms/ga-crisis.html'

    }).state('dashboardAdmin', {

        url: '/dashboard/admin',
        templateUrl: 'app/templates/dashboard-admin.html'

    }).state('editConferenceAdmin', {

        url: '/dashboard/edit/conferences/:schoolGuid/:guid',
        templateUrl: 'app/templates/edit-conference-admin.html'

    }).state('addNewUser', {

        url: '/dashboard/users/new',
        templateUrl: 'app/templates/new-user.html'

    }).state('userWiseAllocation', {

        url: '/dashboard/users/allocations',
        templateUrl: 'app/templates/user-wise-allocation.html'

    });
}]);
'use strict';

angular.module('app').controller('AdministratorDashboardController', ['RestApiService', '$cookies', '$state', '$window', '$scope', function ($rest, $cookies, $state, $window, $scope) {
    var _this = this;

    var isLoggedIn = $cookies.get('isLoggedIn'),
        data = $cookies.get('loginData');

    if (isLoggedIn && data) {

        data = JSON.parse(data);

        $rest.IsValidToken(data.token).then(function (valid) {

            if (valid.valid) {

                if (data.role === 1) {

                    $state.go('dashboardAdmin');
                } else {

                    $state.go('dashboard');
                }
            }
        }).catch(function (err) {

            $state.go('home');
        });
    }

    this.sortType = 'isConfirmed';
    this.sortReverse = false;

    this.ChangeSort = function (sortTypeNew) {

        if (sortTypeNew === _this.sortType) {
            _this.sortReverse = !_this.sortReverse;
        } else {
            _this.sortType = sortTypeNew;
        }
    };

    this.RefreshView = function () {

        _this.isProcessing = true;

        var processingOne = true,
            processingTwo = true;

        $rest.GetAllUsers({

            token: data.token

        }).then(function (data) {

            processingOne = false;
            _this.isProcessing = processingOne || processingTwo;

            _this.users = [];
            data.filter(function (user) {

                if (user.role !== 1) _this.users.push(user);
            });
        });

        $rest.GetAllConferencesForAllUsers(data).then(function (dbData) {

            processingTwo = false;
            _this.isProcessing = processingOne || processingTwo;

            _this.allConferences = [];

            dbData.map(function (conference) {

                conference.areFormsFilled = function () {

                    return conference.registration && conference.delegateInformation && conference.travelArrangements && conference.gaCrisis && conference.registration.isFormFilled && conference.delegateInformation.isFormFilled && conference.travelArrangements.isFormFilled && conference.gaCrisis.isFormFilled;
                }();

                _this.allConferences.push(conference);
            });
        });
    };

    this.DeleteConference = function (conferenceGuid) {

        _this.isProcessing = true;

        $rest.DeleteConference({

            guid: data.guid,
            token: data.token,
            conferenceGuid: conferenceGuid

        }).then(function (res) {

            _this.isProcessing = false;

            _this.hasButtonMessage = true;
            _this.buttonMessage = "Conference confirmed!";
            _this.hasMessage = true;
            _this.messageClass = {
                blue: true
            };
            _this.messageText = "Conference confirmed!";

            $window.location.reload();
        }).catch(function (err) {

            _this.isProcessing = false;

            _this.hasMessage = true;
            _this.messageClass = {
                red: true
            };
            _this.messageText = "An error was encountered while executing that operation!";
        });
    };

    this.ConfirmConference = function (guid) {

        _this.isProcessing = true;

        $rest.ConfirmConference({

            guid: data.guid,
            token: data.token,
            conferenceGuid: guid

        }).then(function (dbData) {

            _this.isProcessing = false;

            _this.hasButtonMessage = true;
            _this.buttonMessage = "Conference confirmed!";
            _this.hasMessage = true;
            _this.messageClass = {
                blue: true
            };
            _this.messageText = "Conference confirmed!";

            $window.location.reload();
        }).catch(function (err) {

            _this.isProcessing = false;

            _this.hasMessage = true;
            _this.messageClass = {
                red: true
            };
            _this.messageText = "An error was encountered while executing that operation!";
        });
    };

    this.UnconfirmConference = function (guid) {

        _this.isProcessing = true;

        $rest.UnconfirmConference({

            guid: data.guid,
            token: data.token,
            conferenceGuid: guid

        }).then(function (dbData) {

            _this.isProcessing = false;

            _this.hasButtonMessage = true;
            _this.buttonMessage = "Conference unconfirmed!";
            _this.hasMessage = true;
            _this.messageClass = {
                blue: true
            };
            _this.messageText = "Conference unconfirmed!";

            $window.location.reload();
        }).catch(function (err) {

            _this.isProcessing = false;

            _this.hasMessage = true;
            _this.messageClass = {
                red: true
            };
            _this.messageText = "An error was encountered while executing that operation!";
        });
    };

    this.RefreshView();
}]);
'use strict';

angular.module('app').controller('BasePageController', ['$cookies', '$state', '$window', 'RestApiService', function ($cookies, $state, $window, $rest) {
    var _this = this;

    var data = $cookies.get('loginData');

    this.showLogout = $cookies.get('isLoggedIn') && data;
    this.Logout = function () {

        var promise = $rest.Logout(JSON.parse(data));
        promise.then(function (data) {

            $cookies.remove('isLoggedIn');
            $cookies.remove('loginData');

            _this.showLogout = false;
            $state.go('home');
        }).catch(function (err) {

            $cookies.remove('isLoggedIn');
            $cookies.remove('loginData');

            _this.showLogout = false;
            $state.go('home');
        });
    };
}]);
'use strict';

angular.module('app').controller('DashboardController', ['RestApiService', '$cookies', '$state', function ($rest, $cookies, $state) {
   var _this = this;

   var isLoggedIn = $cookies.get('isLoggedIn'),
       data = $cookies.get('loginData');

   if (isLoggedIn && data) {

      data = JSON.parse(data);

      $rest.IsValidToken(data.token).then(function (valid) {

         if (!valid.valid) {

            $state.go('home');
         }
      }).catch(function (err) {

         $state.go('home');
      });
   }

   $rest.GetUnconfirmedCount(data).then(function (dat) {

      _this.shouldAddNewButton = dat.data.count === 0;
   });

   var dataPromise = $rest.GetUser(data);
   dataPromise.then(function (dataOut) {

      _this.data = dataOut;
   }).catch(function (data) {

      console.error('The application failed to load with the provided parameters; trying to reload internal state.');
   });

   dataPromise = $rest.GetAllConferences(data);
   dataPromise.then(function (dataIn) {

      _this.hasConferences = dataIn.length !== 0;
      _this.conferences = {
         count: dataIn.length,
         data: dataIn
      };
   }).catch(function (data) {

      console.error('The application failed to load with the provided parameters; trying to reload internal state.');
      $state.go('home');
   });
}]);
'use strict';

angular.module('app').controller('EditConferenceAdminController', ['$stateParams', '$cookies', '$http', '$state', '$window', 'RestApiService', 'lodash', function ($stateParams, $cookies, $http, $state, $window, $rest, _) {
    var _this = this;

    var isLoggedIn = $cookies.get('isLoggedIn'),
        data = $cookies.get('loginData');

    if (isLoggedIn && data) {

        data = JSON.parse(data);

        $rest.IsValidToken(data.token).then(function (valid) {

            if (!valid.valid) {

                $state.go('home');
            }
        }).catch(function (err) {

            $state.go('home');
        });
    }

    var conferenceGuid = $stateParams.guid;

    this.guid = conferenceGuid;
    this.schoolGuid = $stateParams.schoolGuid;

    this.ConfirmConference = function (guid) {

        _this.isProcessing = true;

        $rest.ConfirmConference({

            guid: data.guid,
            token: data.token,
            conferenceGuid: guid

        }).then(function (dbData) {

            _this.isProcessing = false;

            _this.hasMessage = true;
            _this.messageClass = {
                blue: true
            };
            _this.messageText = "Conference confirmed!";
        }).catch(function (err) {

            _this.isProcessing = false;

            _this.hasMessage = true;
            _this.messageClass = {
                red: true
            };
            _this.messageText = "An error was encountered while executing that operation!";
        });
    };

    this.GetAllotments = function (committee) {

        if (!_this.conferenceData.countryAllotment || !_this.conferenceData.countryAllotment.allotments) {
            return [];
        }

        var retVal = [];

        _this.conferenceData.countryAllotment.allotments.map(function (allotment) {

            if (committee === allotment.name) {

                retVal.push(allotment);
            }
        });

        return retVal;
    };

    this.AddTeacherEscort = function () {

        if (_this.conferenceData.registration && _this.conferenceData.registration.teacherEscorts && _this.conferenceData.registration.teacherEscorts.length >= 2) {

            _this.isMessage = true;
            _this.messageHeader = "Warning!";
            _this.messageText = "You can not add any more teacher escorts. The maximum number of teacher escorts per delegation is 2.";
            _this.messageClass = {

                'yellow': true

            };

            return false;
        }

        _this.conferenceData.registration.teacherEscorts = _this.conferenceData.registration.teacherEscorts || [];

        _this.conferenceData.registration.teacherEscorts.push({

            name: 'Escort Name'

        });

        _this.UpdateView();
    };

    this.RemoveEscort = function (index) {

        if (_this.conferenceData.registration && _this.conferenceData.registration.teacherEscorts && _this.conferenceData.registration.teacherEscorts.length <= 0) {

            _this.isMessage = true;
            _this.messageHeader = "Warning!";
            _this.messageText = "You can not remove any more delegates.";
            _this.messageClass = {

                'yellow': true

            };

            return false;
        }

        _this.conferenceData.registration.teacherEscorts = _this.conferenceData.registration.teacherEscorts || [];

        _this.conferenceData.registration.teacherEscorts.splice(index, 1);
        _this.UpdateView();
    };

    this.UpdateView = function () {

        _this.shouldShowNoTeacherEscortMessage = function () {

            if (_this.conferenceData.registration) {

                if (_this.conferenceData.registration.teacherEscorts) {

                    return _this.conferenceData.registration.teacherEscorts.length === 0;
                } else {
                    return false;
                }
            } else {
                return false;
            }
        }();
    };

    this.AddCountryAllotment = function () {

        _this.conferenceData.countryAllotment = function () {

            return _this.conferenceData.countryAllotment ? _this.conferenceData.countryAllotment.allotments ? _this.conferenceData.countryAllotment : { allotments: [] } : { allotments: [] };
        }();

        _this.conferenceData.countryAllotment.allotments.push({

            name: '',
            country: ''

        });
    };

    this.PostNotification = function () {

        _this.isProcessing = true;
        _this.notification.guid = $stateParams.schoolGuid;

        var postData = {

            guid: data.guid,
            token: data.token,
            data: _this.notification

        };

        $rest.PostNewNotification(postData).then(function (data) {

            _this.isProcessing = false;

            _this.isMessage = true;
            _this.messageHeader = "Success!";
            _this.messageText = "A notification was successfully sent to the respective school.";
            _this.messageClass = {

                'green': true

            };

            _this.notification = {};
        }).catch(function (err) {

            _this.isProcessing = false;

            _this.isMessage = true;
            _this.messageHeader = "Error!";
            _this.messageText = "There was an error in sending the notification.";
            _this.messageClass = {

                'red': true

            };
        });
    };

    this.AddGADelegate = function () {

        if (_this.conferenceData.gaCrisis && _this.conferenceData.gaCrisis.delegates && _this.conferenceData.gaCrisis.delegates.length >= 7) {

            _this.isMessage = true;
            _this.messageHeader = "Warning!";
            _this.messageText = "You can not add any more delegates. The maximum number of delegates per delegation is 7.";
            _this.messageClass = {

                'yellow': true

            };

            return false;
        }

        _this.conferenceData.gaCrisis = function () {

            return _this.conferenceData.gaCrisis ? _this.conferenceData.gaCrisis.delegates ? _this.conferenceData.gaCrisis : { delegates: [] } : { delegates: [] };
        }();

        _this.conferenceData.gaCrisis.delegates.push({

            name: 'Delegate Name'

        });

        _this.UpdateView();
    };

    this.RemoveGADelegate = function (index) {

        if (_this.conferenceData.gaCrisis && _this.conferenceData.gaCrisis.delegates && _this.conferenceData.gaCrisis.delegates.length <= 0) {

            _this.isMessage = true;
            _this.messageHeader = "Warning!";
            _this.messageText = "You can not remove any more delegates.";
            _this.messageClass = {

                'yellow': true

            };

            return false;
        }

        _this.conferenceData.gaCrisis = function () {

            return _this.conferenceData.gaCrisis ? _this.conferenceData.gaCrisis.delegates ? _this.conferenceData.gaCrisis : { delegates: [] } : { delegates: [] };
        }();

        _this.conferenceData.gaCrisis.delegates.splice(index, 1);
        _this.UpdateView();
    };

    this.AddDelegate = function () {

        _this.conferenceData.delegateInformation = function () {

            return _this.conferenceData.delegateInformation ? _this.conferenceData.delegateInformation.delegates ? _this.conferenceData.delegateInformation : { delegates: [] } : { delegates: [] };
        }();

        _this.conferenceData.delegateInformation.delegates.push({

            name: 'Delegate Name'

        });

        _this.UpdateView();
    };

    this.RemoveDelegate = function (index) {

        if (_this.conferenceData.delegateInformation && _this.conferenceData.delegateInformation.delegates && _this.conferenceData.delegateInformation.delegates.length <= 0) {

            _this.isMessage = true;
            _this.messageHeader = "Warning!";
            _this.messageText = "You can not remove any more delegates.";
            _this.messageClass = {

                'yellow': true

            };

            return false;
        }

        _this.conferenceData.delegateInformation = function () {

            return _this.conferenceData.delegateInformation ? _this.conferenceData.delegateInformation.delegates ? _this.conferenceData.delegateInformation : { delegates: [] } : { delegates: [] };
        }();

        _this.conferenceData.delegateInformation.delegates.splice(index, 1);
        _this.UpdateView();
    };

    this.UpdateForm = function () {

        _this.processing = true;

        //    this.conferenceData.travelArrangements.onward.departureDate = new Date( Date.UTC( this.conferenceData.travelArrangements.onward.departureDate.getYear(), this.conferenceData.travelArrangements.onward.departureDate.getMonth(), this.conferenceData.travelArrangements.onward.departureDate.getDate() ) );
        //    this.conferenceData.travelArrangements.onward.arrivalDate = new Date( Date.UTC( this.conferenceData.travelArrangements.onward.arrivalDate.getYear(), this.conferenceData.travelArrangements.onward.arrivalDate.getMonth(), this.conferenceData.travelArrangements.onward.arrivalDate.getDate() ) );
        //    this.conferenceData.travelArrangements.returnJourney.departureDate = new Date( Date.UTC( this.conferenceData.travelArrangements.returnJourney.departureDate.getYear(), this.conferenceData.travelArrangements.returnJourney.departureDate.getMonth(), this.conferenceData.travelArrangements.returnJourney.departureDate.getDate() ) );
        //    this.conferenceData.travelArrangements.returnJourney.arrivalDate = new Date( Date.UTC( this.conferenceData.travelArrangements.returnJourney.arrivalDate.getYear(), this.conferenceData.travelArrangements.returnJourney.arrivalDate.getMonth(), this.conferenceData.travelArrangements.returnJourney.arrivalDate.getDate() ) );
        //
        //    console.log( this.conferenceData.travelArrangements.returnJourney );
        //    console.log( this.conferenceData.travelArrangements.onward );

        $rest.UpdateConference({

            token: data.token,
            guid: data.guid,
            conferenceGuid: _this.guid,
            data: _this.conferenceData

        }).then(function (dataIn) {

            if (dataIn.data.statusCode === 200) {

                _this.processing = false;

                _this.isMessage = true;
                _this.messageHeader = "Successful!";
                _this.messageText = "All the details were successfully updated!";
                _this.messageClass = {

                    'blue': true

                };
            }
        });
    };

    this.RefreshView = function () {

        _this.isReloading = true;

        $rest.GetConference({

            conferenceGuid: conferenceGuid,
            token: data.token,
            guid: data.guid

        }).then(function (dataDb) {

            _this.conferenceData = dataDb;
            _this.isReloading = false;

            _this.fieldClasses = {

                'two fields': _this.conferenceData.countryAllotment,
                'field': !_this.conferenceData.countryAllotment

            };

            if (_this.conferenceData.travelArrangements) {

                if (_this.conferenceData.travelArrangements.onward) {

                    if (_this.conferenceData.travelArrangements.onward.arrivalDate) {
                        _this.conferenceData.travelArrangements.onward.arrivalDate = new Date(_this.conferenceData.travelArrangements.onward.arrivalDate);
                    }

                    if (_this.conferenceData.travelArrangements.onward.departureDate) {
                        _this.conferenceData.travelArrangements.onward.departureDate = new Date(_this.conferenceData.travelArrangements.onward.departureDate);
                    }
                }

                if (_this.conferenceData.travelArrangements.returnJourney) {

                    if (_this.conferenceData.travelArrangements.returnJourney.arrivalDate) {
                        _this.conferenceData.travelArrangements.returnJourney.arrivalDate = new Date(_this.conferenceData.travelArrangements.returnJourney.arrivalDate);
                    }

                    if (_this.conferenceData.travelArrangements.returnJourney.departureDate) {
                        _this.conferenceData.travelArrangements.returnJourney.departureDate = new Date(_this.conferenceData.travelArrangements.returnJourney.departureDate);
                    }
                }
            }

            _this.isConferenceConfirmed = _this.conferenceData.isConfirmed;
            _this.areFormsFilled = function () {

                return _this.conferenceData.registration && _this.conferenceData.delegateInformation && _this.conferenceData.travelArrangements && _this.conferenceData.gaCrisis && _this.conferenceData.registration.isFormFilled && _this.conferenceData.delegateInformation.isFormFilled && _this.conferenceData.travelArrangements.isFormFilled && _this.conferenceData.gaCrisis.isFormFilled;
            }();
        });
    };

    this.UpdateView = function () {

        _this.shouldShowNoDelegatesMessage = function () {

            if (_this.conferenceData.delegateInformation) {

                if (_this.conferenceData.delegateInformation.delegates) {

                    return _this.conferenceData.delegateInformation.delegates.length === 0;
                } else {
                    return false;
                }
            } else {
                return false;
            }
        }();
    };

    this.RefreshView();
}]);
'use strict';

angular.module('app').controller('EditConferenceController', ['$stateParams', '$cookies', '$http', '$state', '$window', 'RestApiService', function ($stateParams, $cookies, $http, $state, $window, $rest) {
    var _this = this;

    var isLoggedIn = $cookies.get('isLoggedIn'),
        data = $cookies.get('loginData');

    if (isLoggedIn && data) {

        data = JSON.parse(data);

        $rest.IsValidToken(data.token).then(function (valid) {

            if (!valid.valid) {

                $state.go('home');
            }
        }).catch(function (err) {

            $state.go('home');
        });
    }

    var conferenceGuid = $stateParams.guid;
    this.guid = conferenceGuid;

    $rest.GetNotifications({

        guid: data.guid,
        token: data.token

    }).then(function (data) {

        _this.notifications = data;
    });

    $rest.GetConference({

        conferenceGuid: conferenceGuid,
        token: data.token,
        guid: data.guid

    }).then(function (data) {

        _this.conferenceData = data;

        _this.isAllDone = function () {

            return _this.conferenceData.registration && _this.conferenceData.delegateInformation && _this.conferenceData.travelArrangements && _this.conferenceData.gaCrisis && _this.conferenceData.registration.isFormFilled && _this.conferenceData.delegateInformation.isFormFilled && _this.conferenceData.travelArrangements.isFormFilled && _this.conferenceData.gaCrisis.isFormFilled;
        }();
    });

    this.MarkAsViewed = function (notificationId) {

        $rest.MarkAsViewed({

            notificationId: notificationId,
            guid: data.guid,
            token: data.token

        }).then(function (data) {

            var elem = angular.element('#' + notificationId).closest('.message');
            elem.addClass('successfully-saved').addClass('hide-opacity');
        }).catch(function (err) {

            alert('An error was encountered. Please try again later.');
        });
    };
}]);
'use strict';

angular.module('app').controller('ForgotPasswordController', ['RestApiService', '$state', '$cookies', '$window', function ($restApi, $state, $cookies, $window) {
    var _this = this;

    this.Execute = function () {

        _this.processing = true;

        var resultPromise = $restApi.ForgotPassword(_this.user);

        resultPromise.then(function (dataForgot) {

            _this.processing = false;

            _this.hasMessage = true;
            _this.messageText = "An email outling the steps to reset your password has been sent. Check your email!";
            _this.messageClass = {

                blue: true

            };
        }).catch(function (dataError) {

            _this.processing = false;

            if (dataError.error) {

                _this.hasMessage = true;
                _this.messageText = dataError.message;
                _this.messageClass = {
                    red: true
                };
            }
        });
    };
}]);
'use strict';

angular.module('app').controller('HomePageController', ['RestApiService', '$state', '$cookies', '$window', function ($rest, $state, $cookies, $window) {
    var _this = this;

    var isLoggedIn = $cookies.get('isLoggedIn'),
        data = $cookies.get('loginData');

    if (isLoggedIn && data) {

        data = JSON.parse(data);

        $rest.IsValidToken(data.token).then(function (valid) {

            if (!valid.valid) {

                $state.go('home');
            }
        }).catch(function (err) {

            $state.go('home');
        });
    }

    this.Login = function () {

        _this.isProcessing = true;

        var resultPromise = $rest.Login(_this.user);

        resultPromise.then(function (dataLogin) {

            _this.hasButtonMessage = true;
            _this.buttonMessage = "Redirecting to dashboard...";

            $cookies.put('loginData', JSON.stringify(dataLogin));
            $cookies.put('isLoggedIn', true);

            if (dataLogin.role === 1) {

                $state.go('dashboardAdmin');
            } else {

                $state.go('dashboard');
            }
        }).catch(function (dataError) {

            _this.isProcessing = false;

            if (dataError.loggedIn === false) {

                _this.hasMessage = true;
                _this.messageText = dataError.message;
                _this.messageClass = {
                    red: true
                };
            }
        });
    };
}]);
'use strict';

angular.module('app').controller('NewConferenceController', ['$cookies', '$http', '$state', '$window', 'RestApiService', function ($cookies, $http, $state, $window, $rest) {
    var _this = this;

    var isLoggedIn = $cookies.get('isLoggedIn'),
        data = $cookies.get('loginData');

    if (isLoggedIn && data) {

        data = JSON.parse(data);

        $rest.IsValidToken(data.token).then(function (valid) {

            if (!valid.valid) {

                $state.go('home');
            }
        }).catch(function (err) {

            $state.go('home');
        });
    }

    var self = this;

    this.countries = [{

        code: 'IN',
        name: 'India'

    }, {

        code: 'US',
        name: 'America'

    }];

    this.populateStateList = function (country) {

        $rest.GetStates(country).then(function (data) {

            _this.states = data;
        });
    };

    this.cancel = function () {

        $state.go('dashboard');
    };

    this.NewConference = function () {

        _this.processing = true;

        var dataObject = {

            token: data.token,
            guid: data.guid,
            registration: {

                name: self.conference.registration.facultyAdvisor.firstName + ' ' + self.conference.registration.facultyAdvisor.lastName,
                address: {

                    street: self.conference.registration.address.street,
                    city: self.conference.registration.address.city,
                    pin: self.conference.registration.address.pin,
                    state: self.conference.registration.address.state,
                    country: self.conference.registration.address.country

                },

                facultyAdvisor: {

                    name: self.conference.registration.facultyAdvisor.firstName + ' ' + self.conference.registration.facultyAdvisor.lastName,
                    mobileNumber: self.conference.registration.facultyAdvisor.mobile,
                    landlineNumber: self.conference.registration.facultyAdvisor.landline,
                    email: self.conference.registration.facultyAdvisor.email

                }

            }

        };

        $rest.CreateConference(dataObject).then(function (data) {

            if (data.data.statusCode === 200) {

                _this.processing = false;
                $state.go('dashboard');
            } else {

                _this.isError = true;
                _this.errorMessage = data.data.data.message;
            }
        }).catch(function (data) {

            _this.isError = true;
            _this.errorMessage = data.message;
        });
    };
}]);
'use strict';

angular.module('app').controller('NewUserController', ['$cookies', '$http', '$state', '$window', 'RestApiService', 'CryptoService', 'lodash', function ($cookies, $http, $state, $window, $rest, $crypto, _) {
    var _this = this;

    var isLoggedIn = $cookies.get('isLoggedIn'),
        data = $cookies.get('loginData');

    if (isLoggedIn && data) {

        data = JSON.parse(data);

        $rest.IsValidToken(data.token).then(function (valid) {

            if (!valid.valid) {

                $state.go('home');
            }
        }).catch(function (err) {

            $state.go('home');
        });
    }

    var self = this;

    this.NewUser = function () {

        _this.processing = true;

        var hash = $crypto.getHmac(_this.user.username + _this.user.email, data.guid);

        var dataObject = {

            token: data.token,
            guid: data.guid,
            hash: hash,
            data: _.assign(_this.user, _this.metadata)

        };

        $rest.CreateUser(dataObject).then(function (data) {

            if (data.data.statusCode === 200) {

                _this.processing = false;
                _this.isMessage = true;
                _this.messageClass = {
                    blue: true
                };
                _this.messageHeader = "User Added";
                _this.messageText = 'The user ' + _this.user.username + ' was successfully created.';

                if (data.data.data && data.data.data.generatedPassword) {

                    _this.messageText += ' The generated password is ' + data.data.data.generatedPassword + '.';
                }
            } else {

                _this.processing = false;
                _this.isMessage = true;
                _this.messageClass = {
                    red: true
                };
                _this.messageHeader = "An error was encountered";
                _this.messageText = data.message;
            }
        }).catch(function (data) {

            _this.processing = false;
            _this.isMessage = true;
            _this.messageClass = {
                red: true
            };
            _this.messageHeader = "An error was encountered";
            _this.messageText = data.message;
        });
    };
}]);
'use strict';

angular.module('app').controller('ViewUserWiseController', ['$cookies', '$http', '$state', '$window', 'RestApiService', 'CryptoService', 'lodash', function ($cookies, $http, $state, $window, $rest, $crypto, _) {

    var isLoggedIn = $cookies.get('isLoggedIn'),
        data = $cookies.get('loginData');

    if (isLoggedIn && data) {

        data = JSON.parse(data);

        $rest.IsValidToken(data.token).then(function (valid) {

            if (!valid.valid) {

                $state.go('home');
            }
        }).catch(function (err) {

            $state.go('home');
        });
    }

    var self = this;

    $rest.GetDelegatesAsCommittees(data).then(function (data) {

        self.committees = data.committees;
    });

    self.getDelegates = function (committee) {

        return committee.delegates;
    };
}]);
'use strict';

angular.module('app').filter('reverse', function () {

    return function (items) {

        return items.slice().reverse();
    };
});
'use strict';

angular.module('app').factory('CryptoService', [function () {

    return {

        getSha512: function getSha512(data) {

            var shaObj = new jsSHA("SHA-512", "TEXT");
            shaObj.update(data);
            return shaObj.getHash("HEX");
        },

        getHmac: function getHmac(data, key) {

            var shaObj = new jsSHA('SHA-512', "TEXT");
            shaObj.setHMACKey(key, "TEXT");
            shaObj.update(data);
            return shaObj.getHMAC("HEX");
        }

    };
}]);
'use strict';

angular.module('app').factory('LoginService', ['$cookies', 'RestApiService', '$state', '$q', function ($cookies, $rest, $state, $q) {

    return {
        checkLogin: function checkLogin() {

            var isLoggedIn = $cookies.get('isLoggedIn'),
                data = $cookies.get('loginData'),
                promise = $q.defer();

            if (isLoggedIn && data) {

                data = JSON.parse(data);

                $rest.IsValidToken(data.token).then(function (valid) {

                    if (valid.valid) {

                        promise.resolve({
                            valid: true,
                            data: data
                        });
                    }
                }).catch(function (err) {

                    promise.reject({
                        valid: true
                    });
                });
            }

            return promise.promise;
        },
        getLoginData: function getLoginData() {

            var data = JSON.parse($cookies.get('loginData'));
            return data;
        }
    };
}]);
'use strict';

angular.module('app').factory('RestApiService', ['$http', 'CryptoService', '$q', function ($http, $cryptoService, $q) {

    var apiUrl = 'http://localhost:3345';

    return {
        IsValidToken: function IsValidToken(token) {

            var promise = $q.defer();

            $http.get(apiUrl + '/auth/token/valid/' + token).then(function (data) {

                promise.resolve(data.data.data);
            }).catch(function (data) {

                promise.reject({

                    valid: false

                });
            });

            return promise.promise;
        },
        Login: function Login(userObject) {

            var dataObject = {},
                promise = $q.defer();

            dataObject.username = userObject.username;
            dataObject.password = $cryptoService.getSha512(userObject.password);

            $http.post(apiUrl + '/auth', dataObject).then(function (data) {

                if (data.status === 200 && data.data.data.token) {

                    promise.resolve({

                        token: data.data.data.token,
                        guid: data.data.data.guid,
                        role: data.data.data.role

                    });
                } else {

                    promise.reject({

                        message: data.data.message,
                        loggedIn: false

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    loggedIn: false

                });
            });

            return promise.promise;
        },
        ForgotPassword: function ForgotPassword(userObject) {

            var dataObject = {},
                promise = $q.defer();

            dataObject.username = userObject.username;

            $http.post(apiUrl + '/reset', dataObject).then(function (data) {

                if (data.status === 200) {

                    promise.resolve();
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        PostNewNotification: function PostNewNotification(notificationData) {

            var promise = $q.defer();

            $http.post(apiUrl + '/notifications', {

                token: notificationData.token,
                data: notificationData.data,
                guid: notificationData.guid

            }).then(function (data) {

                if (data.status === 200 || data.status === 201) {

                    promise.resolve();
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        GetUser: function GetUser(data) {

            var promise = $q.defer();

            $http.get(apiUrl + '/users/' + data.guid + '?token=' + data.token).then(function (data) {

                if (data.status === 200 && data.data.data) {

                    promise.resolve(data.data.data[0]);
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        GetAllConferences: function GetAllConferences(data) {

            var promise = $q.defer();

            $http.get(apiUrl + '/conferences?guid=' + data.guid + '&token=' + data.token).then(function (data) {

                if (data.status === 200 && data.data.data) {

                    promise.resolve(data.data.data);
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        GetDelegatesAsCommittees: function GetDelegatesAsCommittees(data) {

            var promise = $q.defer();

            $http.get(apiUrl + '/conferences/as/delegates?guid=' + data.guid + '&token=' + data.token).then(function (data) {

                if (data.status === 200 && data.data.data) {

                    promise.resolve(data.data.data);
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        GetNotifications: function GetNotifications(data) {

            var promise = $q.defer();

            $http.get(apiUrl + '/notifications/' + data.guid + '?token=' + data.token).then(function (data) {

                if (data.status === 200 && data.data.data) {

                    promise.resolve(data.data.data);
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        MarkAsViewed: function MarkAsViewed(data) {

            var promise = $q.defer();

            $http.get(apiUrl + '/notifications/' + data.guid + '/' + data.notificationId + '/viewed?token=' + data.token).then(function (data) {

                if (data.status === 200 || data.status === 201) {

                    promise.resolve();
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        GetAllUsers: function GetAllUsers(data) {

            var promise = $q.defer();

            $http.get(apiUrl + '/users?token=' + data.token).then(function (data) {

                if (data.status === 200 && data.data.data) {

                    promise.resolve(data.data.data);
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        GetAllConferencesForAllUsers: function GetAllConferencesForAllUsers(data) {

            var promise = $q.defer();

            $http.get(apiUrl + '/conferences/all?guid=' + data.guid + '&token=' + data.token).then(function (data) {

                if (data.status === 200 && data.data.data) {

                    promise.resolve(data.data.data);
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        GetUnconfirmedCount: function GetUnconfirmedCount(data) {

            var promise = $q.defer();

            $http.get(apiUrl + '/conferences/unconfirmed/count?guid=' + data.guid + '&token=' + data.token).then(function (data) {

                if (data.status === 200 && data.data.data) {

                    promise.resolve({
                        data: data.data.data
                    });
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        GetUnconfirmedConferences: function GetUnconfirmedConferences(data) {

            var promise = $q.defer();

            $http.get(apiUrl + '/conferences/unconfirmed/all?guid=' + data.guid + '&token=' + data.token).then(function (data) {

                if (data.status === 200 && data.data.data) {

                    promise.resolve({
                        data: data.data.data
                    });
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        GetConference: function GetConference(dataIn) {

            var promise = $q.defer();

            $http.get(apiUrl + '/conferences/' + dataIn.conferenceGuid + '?token=' + dataIn.token + '&guid=' + dataIn.guid).then(function (data) {

                if (data.status === 200 && data.data.data) {

                    promise.resolve(data.data.data[0]);
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        Logout: function Logout(dataIn) {

            var promise = $q.defer();

            $http.post(apiUrl + '/deauth', {

                guid: dataIn.guid,
                token: dataIn.token

            }).then(function (data) {

                if (data.status === 200) {

                    promise.resolve({

                        statusCode: 200

                    });
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        GetStates: function GetStates(country) {

            var promise = $q.defer();

            $http.get(apiUrl + '/metadata/states/' + country).then(function (data) {

                if (data.status === 200 && data.data.data) {

                    promise.resolve(data.data.data);
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        CreateConference: function CreateConference(confUserObject) {

            var promise = $q.defer();

            var dataObject = {

                token: confUserObject.token,
                guid: confUserObject.guid,
                data: {

                    registration: confUserObject.registration

                }

            };

            $http.post(apiUrl + '/conferences', dataObject).then(function (data) {

                if (data.status === 200) {

                    promise.resolve({

                        data: data.data

                    });
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        DeleteConference: function DeleteConference(confObject) {

            var promise = $q.defer();

            $http.delete(apiUrl + '/conferences/' + confObject.conferenceGuid + '?token=' + confObject.token + '&guid=' + confObject.guid).then(function (data) {

                if (data.status === 200 || data.status === 201) {

                    promise.resolve();
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        CreateUser: function CreateUser(confUserObject) {

            var promise = $q.defer();

            var dataObject = {

                token: confUserObject.token,
                data: confUserObject.data,
                hash: confUserObject.hash

            };

            $http.post(apiUrl + '/users', dataObject).then(function (data) {

                if (data.status === 200) {

                    promise.resolve({

                        data: data.data

                    });
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        UpdateConference: function UpdateConference(confUserObject) {

            var promise = $q.defer();

            var dataObject = {

                token: confUserObject.token,
                guid: confUserObject.guid,
                data: confUserObject.data

            };

            $http.put(apiUrl + '/conferences/' + confUserObject.conferenceGuid, dataObject).then(function (data) {

                if (data.status === 200) {

                    promise.resolve({

                        data: data.data

                    });
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        ConfirmConference: function ConfirmConference(confUserObject) {

            var promise = $q.defer();

            var dataObject = {

                token: confUserObject.token,
                guid: confUserObject.guid

            };

            $http.post(apiUrl + '/conferences/confirm/' + confUserObject.conferenceGuid, dataObject).then(function (data) {

                if (data.status === 200 && data.data.data.confirmationId) {

                    promise.resolve({

                        data: data.data

                    });
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        },
        UnconfirmConference: function UnconfirmConference(confUserObject) {

            var promise = $q.defer();

            var dataObject = {

                token: confUserObject.token,
                guid: confUserObject.guid,
                data: {
                    isConfirmed: false,
                    confirmationId: ''
                }

            };

            $http.put(apiUrl + '/conferences/' + confUserObject.conferenceGuid, dataObject).then(function (data) {

                if (data.status === 200) {

                    promise.resolve({

                        data: data.data

                    });
                } else {

                    promise.reject({

                        message: data.data.message,
                        error: true

                    });
                }
            }).catch(function (data) {

                promise.reject({

                    message: data.data.message,
                    error: true

                });
            });

            return promise.promise;
        }
    };
}]);
'use strict';

angular.module('app').controller('DelegateInformationFormController', ['$cookies', '$http', '$stateParams', '$window', 'RestApiService', function ($cookies, $http, $stateParams, $window, $rest) {
    var _this = this;

    var isLoggedIn = $cookies.get('isLoggedIn'),
        data = $cookies.get('loginData'),
        conferenceGuid = $stateParams.guid;

    if (isLoggedIn && data) {

        data = JSON.parse(data);

        $rest.IsValidToken(data.token).then(function (valid) {

            if (!valid.valid) {

                $state.go('home');
            }
        }).catch(function (err) {

            $state.go('home');
        });
    }

    this.guid = conferenceGuid;

    $rest.GetConference({

        conferenceGuid: conferenceGuid,
        token: data.token,
        guid: data.guid

    }).then(function (data) {

        _this.conferenceData = data;

        _this.UpdateView();

        _this.fieldClasses = {

            'two fields': _this.conferenceData.countryAllotment,
            'field': !_this.conferenceData.countryAllotment

        };
    });

    this.GetAllotments = function (committee) {

        if (!_this.conferenceData.countryAllotment || !_this.conferenceData.countryAllotment.allotments) {
            return [];
        }

        var retVal = [];

        _this.conferenceData.countryAllotment.allotments.map(function (allotment) {

            if (committee === allotment.name) {

                retVal.push(allotment);
            }
        });

        return retVal;
    };

    this.AddDelegate = function () {

        if (_this.conferenceData.delegateInformation && _this.conferenceData.delegateInformation.delegates && _this.conferenceData.delegateInformation.delegates.length >= 17) {

            _this.isMessage = true;
            _this.messageHeader = "Warning!";
            _this.messageText = "You can not add any more delegates. The maximum number of delegates per delegation is 17.";
            _this.messageClass = {

                'yellow': true

            };

            return false;
        }

        _this.conferenceData.delegateInformation = function () {

            return _this.conferenceData.delegateInformation ? _this.conferenceData.delegateInformation.delegates ? _this.conferenceData.delegateInformation : { delegates: [] } : { delegates: [] };
        }();

        _this.conferenceData.delegateInformation.delegates.push({

            name: 'Delegate Name'

        });

        _this.UpdateView();
    };

    this.RemoveDelegate = function (index) {

        if (_this.conferenceData.delegateInformation && _this.conferenceData.delegateInformation.delegates && _this.conferenceData.delegateInformation.delegates.length <= 0) {

            _this.isMessage = true;
            _this.messageHeader = "Warning!";
            _this.messageText = "You can not remove any more delegates.";
            _this.messageClass = {

                'yellow': true

            };

            return false;
        }

        _this.conferenceData.delegateInformation = function () {

            return _this.conferenceData.delegateInformation ? _this.conferenceData.delegateInformation.delegates ? _this.conferenceData.delegateInformation : { delegates: [] } : { delegates: [] };
        }();

        _this.conferenceData.delegateInformation.delegates.splice(index, 1);
        _this.UpdateView();
    };

    this.UpdateView = function () {

        _this.shouldShowNoDelegatesMessage = function () {

            if (_this.conferenceData.delegateInformation) {

                if (_this.conferenceData.delegateInformation.delegates) {

                    return _this.conferenceData.delegateInformation.delegates.length === 0;
                } else {
                    return false;
                }
            } else {
                return false;
            }
        }();
    };

    this.UpdateForm = function () {

        _this.processing = true;

        $rest.UpdateConference({

            token: data.token,
            guid: data.guid,
            conferenceGuid: _this.guid,
            data: _this.conferenceData

        }).then(function (dataIn) {

            if (dataIn.data.statusCode === 200) {

                _this.processing = false;

                _this.isMessage = true;
                _this.messageHeader = "Successful!";
                _this.messageText = "All the details were successfully updated!";
                _this.messageClass = {

                    'blue': true

                };
            }
        });
    };
}]);
'use strict';

angular.module('app').controller('GaCrisisFormController', ['lodash', '$cookies', '$http', '$stateParams', '$window', 'RestApiService', function (_, $cookies, $http, $stateParams, $window, $rest) {
    var _this = this;

    var isLoggedIn = $cookies.get('isLoggedIn'),
        data = $cookies.get('loginData');

    if (isLoggedIn && data) {

        data = JSON.parse(data);

        $rest.IsValidToken(data.token).then(function (valid) {

            if (!valid.valid) {

                $state.go('home');
            }
        }).catch(function (err) {

            $state.go('home');
        });
    }

    var conferenceGuid = $stateParams.guid;
    this.guid = conferenceGuid;

    $rest.GetConference({

        conferenceGuid: conferenceGuid,
        token: data.token,
        guid: data.guid

    }).then(function (data) {

        _this.conferenceData = data;
        _this.UpdateView();
    });

    this.RemoveDelegate = function (index) {

        if (_this.conferenceData.gaCrisis && _this.conferenceData.gaCrisis.delegates && _this.conferenceData.gaCrisis.delegates.length <= 0) {

            _this.isMessage = true;
            _this.messageHeader = "Warning!";
            _this.messageText = "You can not remove any more delegates.";
            _this.messageClass = {

                'yellow': true

            };

            return false;
        }

        _this.conferenceData.gaCrisis = function () {

            return _this.conferenceData.gaCrisis ? _this.conferenceData.gaCrisis.delegates ? _this.conferenceData.gaCrisis : { delegates: [] } : { delegates: [] };
        }();

        _this.conferenceData.gaCrisis.delegates.splice(index, 1);
        _this.UpdateView();
    };

    this.UpdateView = function () {

        _this.shouldShowNoDelegatesMessage = function () {

            if (_this.conferenceData.gaCrisis) {

                if (_this.conferenceData.gaCrisis.delegates) {

                    return _this.conferenceData.gaCrisis.delegates.length === 0;
                } else {
                    return false;
                }
            } else {
                return false;
            }
        }();
    };

    this.AddDelegate = function () {

        if (_this.conferenceData.gaCrisis && _this.conferenceData.gaCrisis.delegates && _this.conferenceData.gaCrisis.delegates.length >= 7) {

            _this.isMessage = true;
            _this.messageHeader = "Warning!";
            _this.messageText = "You can not add any more delegates. The maximum number of delegates per delegation is 7.";
            _this.messageClass = {

                'yellow': true

            };

            return false;
        }

        _this.conferenceData.gaCrisis = function () {

            return _this.conferenceData.gaCrisis ? _this.conferenceData.gaCrisis.delegates ? _this.conferenceData.gaCrisis : { delegates: [] } : { delegates: [] };
        }();

        _this.conferenceData.gaCrisis.delegates.push({

            name: 'Delegate Name'

        });

        _this.UpdateView();
    };

    this.UpdateForm = function () {

        _this.processing = true;

        $rest.UpdateConference({

            token: data.token,
            guid: data.guid,
            conferenceGuid: _this.guid,
            data: _this.conferenceData

        }).then(function (dataIn) {

            if (dataIn.data.statusCode === 200) {

                _this.processing = false;

                _this.isMessage = true;
                _this.messageHeader = "Successful!";
                _this.messageText = "All the details were successfully updated!";
                _this.messageClass = {

                    'blue': true

                };
            }
        });
    };
}]);
'use strict';

angular.module('app').controller('MedicalHistoryFormController', ['lodash', '$cookies', '$http', '$stateParams', '$window', 'RestApiService', function (_, $cookies, $http, $stateParams, $window, $rest) {
    var _this = this;

    var isLoggedIn = $cookies.get('isLoggedIn'),
        data = $cookies.get('loginData');

    if (isLoggedIn && data) {

        data = JSON.parse(data);

        $rest.IsValidToken(data.token).then(function (valid) {

            if (!valid.valid) {

                $state.go('home');
            }
        }).catch(function (err) {

            $state.go('home');
        });
    }

    var conferenceGuid = $stateParams.guid;
    this.guid = conferenceGuid;

    $rest.GetConference({

        conferenceGuid: conferenceGuid,
        token: data.token,
        guid: data.guid

    }).then(function (data) {

        _this.conferenceData = data;
    });

    this.UpdateForm = function () {

        _this.processing = true;

        $rest.UpdateConference({

            token: data.token,
            guid: data.guid,
            conferenceGuid: _this.guid,
            data: _this.conferenceData

        }).then(function (dataIn) {

            if (dataIn.data.statusCode === 200) {

                _this.processing = false;

                _this.isMessage = true;
                _this.messageHeader = "Successful!";
                _this.messageText = "All the details were successfully updated!";
                _this.messageClass = {

                    'blue': true

                };
            }
        });
    };
}]);
'use strict';

angular.module('app').controller('RegistrationFormController', ['$cookies', '$http', '$stateParams', '$window', 'RestApiService', function ($cookies, $http, $stateParams, $window, $rest) {
    var _this = this;

    var guid = $stateParams.guid;

    var isLoggedIn = $cookies.get('isLoggedIn'),
        data = $cookies.get('loginData');

    if (isLoggedIn && data) {

        data = JSON.parse(data);

        $rest.IsValidToken(data.token).then(function (valid) {

            if (!valid.valid) {

                $state.go('home');
            }
        }).catch(function (err) {

            $state.go('home');
        });
    }

    this.guid = $stateParams.guid;

    $rest.GetConference({

        token: data.token,
        guid: data.guid,
        conferenceGuid: guid

    }).then(function (data) {

        _this.conferenceData = data;
        _this.UpdateView();
    });

    this.AddTeacherEscort = function () {

        if (_this.conferenceData.registration && _this.conferenceData.registration.teacherEscorts && _this.conferenceData.registration.teacherEscorts.length >= 2) {

            _this.isMessage = true;
            _this.messageHeader = "Warning!";
            _this.messageText = "You can not add any more teacher escorts. The maximum number of teacher escorts per delegation is 2.";
            _this.messageClass = {

                'yellow': true

            };

            return false;
        }

        _this.conferenceData.registration.teacherEscorts = _this.conferenceData.registration.teacherEscorts || [];

        _this.conferenceData.registration.teacherEscorts.push({

            name: 'Escort Name'

        });

        _this.UpdateView();
    };

    this.RemoveEscort = function (index) {

        if (_this.conferenceData.registration && _this.conferenceData.registration.teacherEscorts && _this.conferenceData.registration.teacherEscorts.length <= 0) {

            _this.isMessage = true;
            _this.messageHeader = "Warning!";
            _this.messageText = "You can not remove any more delegates.";
            _this.messageClass = {

                'yellow': true

            };

            return false;
        }

        _this.conferenceData.registration.teacherEscorts = _this.conferenceData.registration.teacherEscorts || [];

        _this.conferenceData.registration.teacherEscorts.splice(index, 1);
        _this.UpdateView();
    };

    this.UpdateView = function () {

        _this.shouldShowNoTeacherEscortMessage = function () {

            if (_this.conferenceData.registration) {

                if (_this.conferenceData.registration.teacherEscorts) {

                    return _this.conferenceData.registration.teacherEscorts.length === 0;
                } else {
                    return false;
                }
            } else {
                return false;
            }
        }();
    };

    this.UpdateForm = function () {

        _this.processing = true;

        $rest.UpdateConference({

            token: data.token,
            guid: data.guid,
            conferenceGuid: guid,
            data: _this.conferenceData

        }).then(function (dataIn) {

            if (dataIn.data.statusCode === 200) {

                _this.processing = false;

                _this.isMessage = true;
                _this.messageHeader = "Successful!";
                _this.messageText = "All the details were successfully updated!";
                _this.messageClass = {

                    'blue': true

                };
            }
        });
    };
}]);
'use strict';

angular.module('app').controller('TravelArrangementsFormController', ['$cookies', '$http', '$stateParams', '$window', 'RestApiService', function ($cookies, $http, $stateParams, $window, $rest) {
    var _this = this;

    var isLoggedIn = $cookies.get('isLoggedIn'),
        data = $cookies.get('loginData');

    if (isLoggedIn && data) {

        data = JSON.parse(data);

        $rest.IsValidToken(data.token).then(function (valid) {

            if (!valid.valid) {

                $state.go('home');
            }
        }).catch(function (err) {

            $state.go('home');
        });
    }

    var conferenceGuid = $stateParams.guid;
    this.guid = conferenceGuid;

    $rest.GetConference({

        conferenceGuid: conferenceGuid,
        token: data.token,
        guid: data.guid

    }).then(function (data) {

        _this.conferenceData = data;

        if (_this.conferenceData.travelArrangements) {

            if (_this.conferenceData.travelArrangements.onward) {

                if (_this.conferenceData.travelArrangements.onward.arrivalDate) {
                    _this.conferenceData.travelArrangements.onward.arrivalDate = new Date(_this.conferenceData.travelArrangements.onward.arrivalDate);
                }

                if (_this.conferenceData.travelArrangements.onward.departureDate) {
                    _this.conferenceData.travelArrangements.onward.departureDate = new Date(_this.conferenceData.travelArrangements.onward.departureDate);
                }
            }

            if (_this.conferenceData.travelArrangements.returnJourney) {

                if (_this.conferenceData.travelArrangements.returnJourney.arrivalDate) {
                    _this.conferenceData.travelArrangements.returnJourney.arrivalDate = new Date(_this.conferenceData.travelArrangements.returnJourney.arrivalDate);
                }

                if (_this.conferenceData.travelArrangements.returnJourney.departureDate) {
                    _this.conferenceData.travelArrangements.returnJourney.departureDate = new Date(_this.conferenceData.travelArrangements.returnJourney.departureDate);
                }
            }
        }
    });

    this.UpdateForm = function () {

        _this.processing = true;

        $rest.UpdateConference({

            token: data.token,
            guid: data.guid,
            conferenceGuid: _this.guid,
            data: _this.conferenceData

        }).then(function (dataIn) {

            if (dataIn.data.statusCode === 200) {

                _this.processing = false;

                _this.isMessage = true;
                _this.messageHeader = "Successful!";
                _this.messageText = "All the details were successfully updated!";
                _this.messageClass = {

                    'blue': true

                };
            }
        });
    };
}]);
//# sourceMappingURL=app.min.js.map
